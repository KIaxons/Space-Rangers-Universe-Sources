{
  "FileID":  573785173,
  "FileVersion":  8,
  "ViewPos.x":  -245,
  "ViewPos.y":  -316,
  "ScriptName":"Mod_ExpRepair",
  "ScriptFileOut":"H:\\Mod_ExpRepair.scr",
  "ScriptTextOut":"H:\\Mod_ExpRepair.txt",
  "GraphPoint.Count":  242,
  "GraphLink.Count":  219,
  "GraphRectText.Count":  4,
  "Variables.Count":  40,
  "Stars.Count":  1,
  "Planets.Count":  1,
  "Ships.Count":  1,
  "States.Count":  1,
  "Groups.Count":  1,
  "Places.Count":  0,
  "Items.Count":  0,
  "Ethers.Count":  0,
  "Dialogs.Count":  21,
  "DialogMessages.Count":  40,
  "DialogAnswers.Count":  9,
  "Operations.Count":  71,
  "Statements.Count":  56,
  "Loops.Count":  0,
  "Visual.Objects":  
  [
    {
      "DialogAnswers":      
      [
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          480,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          19,
          "Msg":"",
          "AMsg.Num":"0"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          560,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          21,
          "Msg":"",
          "AMsg.Num":"1"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          480,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          63,
          "Msg":"",
          "AMsg.Num":"2"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          560,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          69,
          "Msg":"",
          "AMsg.Num":"3"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          590,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          163,
          "Msg":"",
          "AMsg.Num":"4"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          490,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          166,
          "Msg":"",
          "AMsg.Num":"5"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          189,
          "#":          190,
          "Msg":"",
          "AMsg.Num":"6"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          201,
          "#":          202,
          "Msg":"",
          "AMsg.Num":"7"        
        },
        {
          "Type":"TDialogAnswer",
          "Name":"exit",
          "Pos.x":          20,
          "Pos.y":          0,
          "Parent":          226,
          "#":          227,
          "Msg":"",
          "AMsg.Num":"8"        
        }      
      ],
      "DialogMessages":      
      [
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          8,
          "Msg":"Наши ремонтники могут починить и провести профилактику любого оборудования на корабле. Всё установленное оборудование - как стандартное, так и специальное - после нашего ремонта будет как новенькое. Услуги обойдутся недёшево, но зато работа будет произведена идеально.\r\nНа выбор мы можем предложить один из <clr>пяти<clrEnd> вариантов комплексного ремонта:\r\n<DefSplt>\r\n<clr>1.<clrEnd> Ремонт оборудования, установленного в настоящий момент\r\n<clr>2.<clrEnd> Ремонт оборудования, входящего в состав всех ваших комплектаций (включая текущую)\r\n<clr>3.<clrEnd> Ремонт всех артефактов в слотах и в трюме\r\n<clr>4.<clrEnd> Ремонт всех исследовательских зондов\r\n<clr>5.<clrEnd> Ремонт вообще всего, что только можно починить на борту\r\n<DefSplt>\r\nТак что из этого вам необходимо?",
          "DMsg.Num":"0"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          18,
          "Msg":"Сейчас посмотрим...\r\n...\r\n<AddText> в отличном состоянии и не требует ремонта.",
          "DMsg.Num":"1"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          20,
          "Msg":"<AddText> Были рады помочь вам, рейнджер <Player>.",
          "DMsg.Num":"2"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          80,
          "Parent":          -1,
          "#":          37,
          "Msg":"Сейчас посмотрим...\r\n...\r\n<AddText>\r\n\r\nВот наша калькуляция:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr.\r\n\r\nСогласен, много - а что поделаешь? Поломок-то ведь тьма тьмущая!",
          "DMsg.Num":"3"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          38,
          "Msg":"Сейчас посмотрим...\r\n...\r\nТак, так... Есть некоторые поломки, мы всё это устраним за символическую плату. О'кей?\r\n\r\nСмотрите, вот наша калькуляция:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr.",
          "DMsg.Num":"4"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          45,
          "Msg":"<AddText>",
          "DMsg.Num":"5"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          190,
          "Parent":          -1,
          "#":          52,
          "Msg":"Ну, смотри, братан - наши местные кулибины от гаечного плазмоключа и шестерни чинят вообще всё, да притом бесплатно и без SMS. Хотя про бесплатно - это я тебя приколол, жить то им на что-то надо.\r\nКороче, на выбор можем предложить <clr>пять<clrEnd> вариантов:\r\n<DefSplt>\r\n<clr>1.<clrEnd> Ремонт оборудования, установленного прямо сейчас\r\n<clr>2.<clrEnd> Ремонт оборудования в составе всех твоих комплектаций (и текущей тоже)\r\n<clr>3.<clrEnd> Ремонт всех артефактов, что найдём у тебя на борту\r\n<clr>4.<clrEnd> Ремонт всех твоих исследовательских зондов\r\n<clr>5.<clrEnd> Всё вместе (вообще всё), типа \"all inclusive\"\r\n<DefSplt>\r\nЧто выбираешь?",
          "DMsg.Num":"6"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          62,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\n<AddText>",
          "DMsg.Num":"7"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          500,
          "Pos.y":          240,
          "Parent":          -1,
          "#":          64,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\n<AddText>\r\n<AddTextNodes>\r\n\r\nВот наша цена со скидкой:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт особых пушек: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nВсего: <tstr2><total> cr. и <nod_cost> нд.\r\n\r\nПонимаю, цифры недетские, ну так и технику с того света возвращать - задача не из лёгких. Так что, по рукам?",
          "DMsg.Num":"8"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          68,
          "Msg":"<AddText>",
          "DMsg.Num":"9"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          71,
          "Msg":"<AddText>",
          "DMsg.Num":"10"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          500,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          81,
          "Msg":"Сейчас посмотрим...\r\n...\r\n<AddText>\r\n<AddTextNodes>\r\n\r\nВот наша калькуляция:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nНестандартный ремонт: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr. и <nod_cost> нд.\r\n\r\nСогласен, много - а что поделаешь? Поломок-то ведь тьма тьмущая!",
          "DMsg.Num":"11"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          500,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          83,
          "Msg":"Сейчас посмотрим...\r\n...\r\nТак, так... Есть некоторые поломки, мы всё это устраним за символическую плату. О'кей?\r\n<AddTextNodes>\r\n\r\nСмотрите, вот наша калькуляция:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nНестандартный ремонт: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr. и <nod_cost> нд.",
          "DMsg.Num":"12"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          86,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\n<AddText>\r\n\r\nВот наша цена со скидкой:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nВсего: <tstr2><total> cr.\r\n\r\nТак что, по рукам?",
          "DMsg.Num":"13"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          91,
          "Msg":"<AddText>",
          "DMsg.Num":"14"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          390,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          94,
          "Msg":"<AddText>",
          "DMsg.Num":"15"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          98,
          "Msg":"<AddText>",
          "DMsg.Num":"16"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          115,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\nНу вот что, <Player> - по нашим расценкам полный ремонт всех твоих побрякушек тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\r\nС этой скидкой весь ремонт тебе встанет в <total> cr. По рукам?",
          "DMsg.Num":"17"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          119,
          "Msg":"<AddText>",
          "DMsg.Num":"18"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          122,
          "Msg":"<AddText>",
          "DMsg.Num":"19"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          480,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          127,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\n<AddText>\r\n\r\nВот наша цена со скидкой:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nВсего: <tstr2><total> cr.\r\n\r\nПонимаю, цифры недетские, ну так и технику с того света возвращать - задача не из лёгких. Так что, по рукам?",
          "DMsg.Num":"20"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          500,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          128,
          "Msg":"А ну-ка сейчас заценим...\r\n...\r\n<AddText>\r\n<AddTextNodes>\r\n\r\nВот наша цена со скидкой:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт особых пушек: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nВсего: <tstr2><total> cr. и <nod_cost> нд.\r\n\r\nТак что, по рукам?",
          "DMsg.Num":"21"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          136,
          "Msg":"Починить, говорите? Это вы по адресу!\r\nНаша сеть технологических центров уже давно славится самыми качественными и самыми быстрыми ремонтами в Галактике! Да что говорить! Первый центр был ОСНОВАН на желании обеспечить всех желающих качественным и доступным техсервисом. Но предупреждаю сразу - на ремонт нестандартного оборудования у нас наценка. Эти жлобы с научных баз свою копеечку с лицензии считают как никто.\r\nИтак, на выбор мы можем предложить <clr>пять<clrEnd> вариантов оперативной починки:\r\n<DefSplt>\r\n<clr>1.<clrEnd> Ремонт оборудования, установленного в настоящий момент\r\n<clr>2.<clrEnd> Ремонт оборудования, входящего в состав всех ваших комплектаций (включая текущую)\r\n<clr>3.<clrEnd> Ремонт всех артефактов в слотах и в трюме\r\n<clr>4.<clrEnd> Ремонт всех исследовательских зондов\r\n<clr>5.<clrEnd> Ремонт вообще всего, что только можно починить на борту\r\n<DefSplt>\r\nКакой предпочитаете?",
          "DMsg.Num":"22"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          380,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          151,
          "Msg":"<AddText>",
          "DMsg.Num":"23"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          490,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          154,
          "Msg":"<AddText>",
          "DMsg.Num":"24"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          158,
          "Msg":"<AddText>",
          "DMsg.Num":"25"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          160,
          "Msg":"<AddText>",
          "DMsg.Num":"26"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          590,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          165,
          "Msg":"<AddText>",
          "DMsg.Num":"27"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          470,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          169,
          "Msg":"Так-так, проведём-ка техосмотр...\r\n...\r\nПохоже, <AddText> в отличном состоянии и не требует ремонта.",
          "DMsg.Num":"28"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          470,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          177,
          "Msg":"Так-так, проведём-ка техосмотр...\r\n...\r\nДа, похоже, кое-что и, правда, поломалось, но ничего серьёзного. Исправим в считанные часы.\r\n\r\nВот полная стоимость работ:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr.",
          "DMsg.Num":"29"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          470,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          178,
          "Msg":"Так-так, проведём-ка техосмотр...\r\n...\r\n<AddText>\r\n\r\nВот полная стоимость работ:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr.\r\n\r\nДа, недёшево, однако и работы тут непочатый край - уж не обессудьте.",
          "DMsg.Num":"30"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          490,
          "Pos.y":          520,
          "Parent":          -1,
          "#":          179,
          "Msg":"Так-так, проведём-ка техосмотр...\r\n...\r\n<AddText>\r\n<AddTextNodes>\r\n\r\nВот полная стоимость работ:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nНестандартный ремонт: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr. и <nod_cost> нд.\r\n\r\nДа, недёшево, однако и работы тут непочатый край - уж не обессудьте.",
          "DMsg.Num":"31"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          490,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          180,
          "Msg":"Так-так, проведём-ка техосмотр...\r\n...\r\nДа, похоже, кое-что и, правда, поломалось, но ничего серьёзного. Исправим в считанные часы.\r\n<AddTextNodes>\r\n\r\nВот полная стоимость работ:\r\n<DefSplt>\r\nРемонт оборудования: <tstr2><item_cost> cr.\r\nНестандартный ремонт: <tstr2><domik_wpn_cost> cr.\r\nДоп. материалы: <tstr2><nod_cost> нд.\r\nРемонт артефактов: <tstr2><art_cost> cr.\r\n<DefSplt>\r\nИтого: <tstr2><total> cr. и <nod_cost> нд.",
          "DMsg.Num":"32"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          188,
          "#":          189,
          "Msg":"<tstr1>",
          "DMsg.Num":"33"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          192,
          "#":          193,
          "Msg":"<tstr1>",
          "DMsg.Num":"34"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          200,
          "#":          201,
          "Msg":"<tstr1>",
          "DMsg.Num":"35"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          214,
          "#":          215,
          "Msg":"<tstr1>",
          "DMsg.Num":"36"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          219,
          "#":          220,
          "Msg":"<tstr1>",
          "DMsg.Num":"37"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          0,
          "Parent":          237,
          "#":          226,
          "Msg":"<tstr1>",
          "DMsg.Num":"38"        
        },
        {
          "Type":"TDialogMsg",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          229,
          "#":          230,
          "Msg":"<tstr1>",
          "DMsg.Num":"39"        
        }      
      ],
      "Dialogs":      
      [
        {
          "Type":"TDialog",
          "Name":"Repair_SB",
          "Pos.x":          120,
          "Pos.y":          0,
          "Parent":          -1,
          "#":          6        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_SB_ship",
          "Pos.x":          140,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          10        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_SB_fix",
          "Pos.x":          610,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          41        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_SB_no",
          "Pos.x":          610,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          44        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_PB",
          "Pos.x":          120,
          "Pos.y":          140,
          "Parent":          -1,
          "#":          50        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_PB_ship",
          "Pos.x":          140,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          54        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_PB_fix",
          "Pos.x":          610,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          66        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_PB_no",
          "Pos.x":          610,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          70        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_PB_player",
          "Pos.x":          170,
          "Pos.y":          190,
          "Parent":          -1,
          "#":          74        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_SB_player",
          "Pos.x":          170,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          75        
        },
        {
          "Type":"TDialog",
          "Name":"GetBack",
          "Pos.x":          -180,
          "Pos.y":          70,
          "Parent":          191,
          "#":          104        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_TC",
          "Pos.x":          120,
          "Pos.y":          420,
          "Parent":          -1,
          "#":          134        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_TC_ship",
          "Pos.x":          140,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          138        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_TC_player",
          "Pos.x":          170,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          139        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_TC_fix",
          "Pos.x":          630,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          155        
        },
        {
          "Type":"TDialog",
          "Name":"Repair_TC_no",
          "Pos.x":          630,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          156        
        },
        {
          "Type":"TDialog",
          "Name":"RepairDialog",
          "Pos.x":          -30,
          "Pos.y":          -280,
          "Parent":          -1,
          "#":          191        
        },
        {
          "Type":"TDialog",
          "Name":"RepairPlayer",
          "Pos.x":          -100,
          "Pos.y":          0,
          "Parent":          194,
          "#":          195        
        },
        {
          "Type":"TDialog",
          "Name":"RepairPartner",
          "Pos.x":          30,
          "Pos.y":          0,
          "Parent":          194,
          "#":          196        
        },
        {
          "Type":"TDialog",
          "Name":"RepairYes",
          "Pos.x":          -20,
          "Pos.y":          30,
          "Parent":          221,
          "#":          222        
        },
        {
          "Type":"TDialog",
          "Name":"RepairNo",
          "Pos.x":          70,
          "Pos.y":          30,
          "Parent":          221,
          "#":          223        
        }      
      ],
      "Groups":      
      [
        {
          "Type":"TGroup",
          "Name":"PlayerGroup",
          "Pos.x":          10,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          3,
          "Owner":          62,
          "Group.Type":          126,
          "CntShipMin":          1,
          "CntShipMax":          1,
          "SpeedMin":          100,
          "SpeedMax":          10000,
          "Weapon":          0,
          "CargoHook":          0,
          "EmptySpace":          0,
          "AddPlayer":true,
          "StatusTraderMin":          0,
          "StatusTraderMax":          100,
          "StatusWarriorMin":          0,
          "StatusWarriorMax":          100,
          "StatusPirateMin":          0,
          "StatusPirateMax":          100,
          "DistSearch":          10000,
          "Dialog":          -1,
          "StrengthMin":"0",
          "StrengthMax":"0",
          "Ruins":""        
        }      
      ],
      "Operations":      
      [
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          40,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          5,
          "Total.Lines":          1,
          "Code.Type":"Global",
          "Code":          
          [
"GRun();"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          7,
          "Total.Lines":          64,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(ship);",
"ArrayClear(nodes_count_array);",
"",
"//Цикл, пока не закончатся все напарники рейнджеры",
"for(i = 0; i < ShipPartners(Player()); i = i + 1)",
"{",
"    cur_ship = ShipPartners(Player(), i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"for(i = 0; i < PlayerPirates(); i = i + 1)",
"{//цикл, пока не закончатся все напарники пираты",
"    cur_ship = PlayerPirates(i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"//Цикл, пока не закончатся все активные транки",
"for(i = 0; i < PlayerTranclucators(); i = i + 1)",
"{",
"    cur_ship=PlayerTranclucators(i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"//Цикл, пока не закончатся все артефакты в трюме (ищем транков)",
"for(i = 0; i < ShipArts(Player()); i = i + 1)",
"{",
"    cur_item = ShipArts(Player(), i);",
"    if(ItemType(cur_item) == t_ArtefactTranclucator) ArrayAdd(ship, ArtTranclucatorToShip(cur_item));",
"}",
"",
"item_cost = 0; //Стоимость оборудки",
"art_cost = 0; //Стоимость артов",
"domik_wpn_cost = 0; //Стоимость дом. оружия",
"nod_cost = 0; //Всего нодов",
"nod_cost_float = 0;",
"cost = 0; //Общая стоимость",
"max_duration = 0;",
"AddText = '';",
"AddTextNodes = '';",
"tstr = '';",
"tstr2 = '';",
"AnsCount=0;",
"bad_equipments = 0; //Переменная, обозначающая тяжёлые повреждения",
"bad_equipments_count = 0;",
"total = 0;",
"",
"//Установка длины \"дефисного разделителя\" и отступа в зависимости от выбранного в игре размера шрифта",
"if(!GetGameOptions('FontDialog'))",
"{",
"    DefSplt = '</color>-----------------------------------------------------------';",
"    tstr2 = CT('FormInfo.td_310') + CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog') == 1)",
"{",
"    DefSplt = '</color>------------------------------------------';",
"    tstr2 = CT('FormInfo.td_312') + CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog') == 2)",
"{",
"    DefSplt = '</color>-------------------------------------------';",
"    tstr2 = CT('FormInfo.td_324') + CT('FormInfo.align_right');",
"}",
"else",
"{",
"    DefSplt = '</color>--------------------------------------';",
"    tstr2 = CT('FormInfo.td_325') + CT('FormInfo.align_right');",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          140,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          9,
          "Total.Lines":          40,
          "Code.Type":"Turn",
          "Code":          
          [
"InjectAnswer('Repair_SB_player', \"Чинить текущее оборудование\", 0);",
"InjectAnswer('Repair_SB_player', \"Чинить оборудование в составе комплектаций\", 1);",
"if(!ShipArts(Player())) AddDialogBlock(\"Чинить артефакты\", 1);",
"InjectAnswer('Repair_SB_player', \"Чинить артефакты\", 2);",
"//Ищем в трюме хотя бы один зонд",
"tint = 0;",
"for(i = 0; i < ShipItems(Player()); i = i + 1)",
"{",
"    cur_item = ShipItems(Player(), i);",
"    //Пропускаем всё, кроме зондов",
"    if(ItemType(cur_item) != t_Satellite) continue;",
"    tint = 1;",
"    break;",
"}",
"if(!tint) AddDialogBlock(\"Чинить зонды\", 1);",
"InjectAnswer('Repair_SB_player', \"Чинить зонды\", 3);",
"InjectAnswer('Repair_SB_player', \"Чинить всё\", 4);",
"",
"if(ArrayDim(ship) - 1)",
"{",
"    for(i = 1; i < ArrayDim(ship); i = i + 1)",
"    {",
"        cur_ship = ship[i];",
"        if(ShipTypeN(cur_ship) == t_Tranclucator) InjectAnswer('Repair_SB_ship', \"Чинить <ShipName(cur_ship)>\", cur_ship);",
"        else if(ShipTypeN(cur_ship) == t_Ranger)",
"        {",
"            if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer') InjectAnswer('Repair_SB_ship', \"Чинить оборудование наёмника <ShipName(cur_ship)>\", cur_ship);",
"            else if(ShipType(cur_ship) == 'RangerPirate' || ShipType(cur_ship) == 'RangerPirateExplorer') InjectAnswer('Repair_SB_ship', \"Чинить оборудование братана <ShipName(cur_ship)>\", cur_ship);",
"            else if(ShipType(cur_ship) == 'FemRanger') InjectAnswer('Repair_SB_ship', \"Чинить оборудование спецагента <ShipName(cur_ship)>\", cur_ship);",
"            else InjectAnswer('Repair_SB_ship', \"Чинить оборудование рейнджера <ShipName(cur_ship)>\", cur_ship);",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Pirate)",
"        {",
"            if(ShipType(cur_ship) == 'Rebel') InjectAnswer('Repair_SB_ship', \"Чинить оборудование повстанца <ShipName(cur_ship)>\", cur_ship);",
"            else if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer') InjectAnswer('Repair_SB_ship', \"Чинить оборудование наёмника <ShipName(cur_ship)>\", cur_ship);",
"            else InjectAnswer('Repair_SB_ship', \"Чинить оборудование братана <ShipName(cur_ship)>\", cur_ship);",
"        }",
"    }",
"}",
"InjectAnswer('GetBack', \"Сейчас пока ничего, извините\", -1);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          11,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship = Player();"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          300,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          12,
          "Total.Lines":          3,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship = GAnswerData;",
"TrankRep = 0;",
"if(ShipTypeN(cur_ship) == t_Tranclucator) TrankRep = 1;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          13,
          "Total.Lines":          86,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);",
"    if(!ShipCanRepairEq(cur_ship, cur_item)) continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item) > -1)",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет всегда корпус",
"    if(!i)",
"    {",
"        bad_equipments_count = bad_equipments_count + 1;",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship);",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;",
"    }",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue;",
"    if(ItemType(cur_item) > t_Hull && ItemType(cur_item) < t_Protoplasm)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"            bad_equipments_count = bad_equipments_count + 1;",
"        }",
"        //Если износ оборудки больше 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable;",
"            ArrayAdd(items, cur_item);",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                //Отдельно считаем стоимость ремонта дом. оружия",
"                domik_wpn_cost = domik_wpn_cost + variable;",
"                nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                item_cost = item_cost - variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    //Отдельно считаем стоимость ремонта дом. оружия",
"                    domik_wpn_cost = domik_wpn_cost + variable;",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"//Перебор всех артов",
"for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipArts(cur_ship, i);",
"    if(!ItemCanBeBroken(cur_item)) continue; //Пропуск, если арт не может сломаться",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue; //Пропуск, если арт не в комплектации",
"    if(ItemIsInUse(cur_item))",
"    {",
"        bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"        bad_equipments_count = bad_equipments_count + 1;",
"    }",
"    //Если износ арта больше 10%",
"    if(ItemDurability(cur_item) < 90)",
"    {",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"        art_cost = art_cost + variable;",
"        ArrayAdd(items, cur_item);",
"    }",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          14,
          "Total.Lines":          79,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"//Перебор всей оборудки корабля",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);",
"    if(!ShipCanRepairEq(cur_ship, cur_item)) continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(~EqSpecial(cur_item))",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет всегда корпус",
"    if(!i)",
"    {",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship); //Запомнили % повреждения корпуса",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;",
"    }",
"    if(!ItemIsInUse(cur_item)) continue; //Если оборудование используется в текущем сете",
"    if(ItemType(cur_item) > t_Hull && ItemType(cur_item) < t_Protoplasm)",
"    {",
"        bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если износ оборудки больше 10%",
"        if (ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable; //Продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items, cur_item);",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                domik_wpn_cost = domik_wpn_cost + variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                item_cost = item_cost - variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost = domik_wpn_cost + variable; //Отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"//Перебор всех артов",
"for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipArts(cur_ship, i);",
"    if(!ItemCanBeBroken(cur_item)) continue; //Пропуск если арт не может сломаться",
"    if(!ItemIsInUse(cur_item)) continue;",
"    bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"    bad_equipments_count = bad_equipments_count + 1;",
"    //Если износ арта больше 10%",
"    if(ItemDurability(cur_item) < 90)",
"    {",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"        art_cost = art_cost + variable;",
"        ArrayAdd(items, cur_item);",
"    }",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          420,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          17,
          "Total.Lines":          37,
          "Code.Type":"Turn",
          "Code":          
          [
"//Не менее одного нода на нестандартный ремонт",
"if(domik_wpn_cost)",
"{",
"    nod_cost = round(nod_cost_float);",
"    if(nod_cost <= 0) nod_cost = 1;",
"}",
"tstr = '';",
"variable = 0;",
"art_cost = round(0.84 * art_cost);",
"total = item_cost + art_cost + domik_wpn_cost;",
"if(bad_equipments / bad_equipments_count >= 60) bad_equipments = 1;",
"else bad_equipments = 0;",
"",
"//Готовим ответные реплики для \"тяжёлого\" и нестандартного ремонта",
"if(cur_ship == Player())",
"{",
"    AddText = \"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Вы вообще не боитесь на нём летать?\";",
"    AddTextNodes = \"</color>Да, и ещё. На вашем корабле установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>.\";",
"}",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship) == 'Merc')",
"    {",
"        AddText = \"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Ох уж эти наёмники - бесстрашные ребята!\";",
"        AddTextNodes = \"</color>Да, и ещё. На корабле наёмника установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>.\";",
"    }",
"    else",
"    {",
"        AddText = \"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Ваш напарник вообще не боится на нём летать?\";",
"        AddTextNodes = \"</color>Да, и ещё. На корабле вашего напарника установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>.\";",
"    }",
"}",
"else",
"{",
"    AddText = \"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние транклюкатора и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить своего помощника? Вы вообще не боитесь выпускать его в космос?\";",
"    AddTextNodes = \"</color>Да, и ещё. На транклюкаторе установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>.\";",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          80,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          22,
          "Total.Lines":          24,
          "Code.Type":"DialogBegin",
          "Code":          
          [
"cur_ruin = GetShipRuins(Player());",
"if(cur_ruin)",
"{",
"    if(!PlayerBridge())",
"    {",
"        CurRuinTypeStr = ShipType(cur_ruin);",
"        CurRuinTypeStr = Format(CurRuinTypeStr, '_licensed', '', '');",
"        if(CurRuinTypeStr == 'WB')",
"        {",
"            AddDialogBlock('Mod_alter_repair_DialogBlock', 2);",
"            AddDialogInject('RepairDialog', '', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepair'), 1);",
"        }",
"        else if(CurRuinTypeStr == 'SB' || CurRuinTypeStr == 'PB')",
"        {",
"            AddDialogBlock('Mod_alter_repair_DialogBlock', 2);",
"            AddDialogInject('Repair_' + CurRuinTypeStr, '', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepair'), 1);",
"        }",
"        else if(CurRuinTypeStr == 'TC')",
"        {",
"            //Приоритет подстановки диалога здесь другой",
"            AddDialogInject('Repair_TC', '', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepair'), 5);",
"        }",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          60,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          23,
          "Total.Lines":          44,
          "Code.Type":"Init",
          "Code":          
          [
"items=newarray(1);",
"ship=newarray(1);",
"nodes_count_array=newarray(1);",
"",
"//Функция расчёта стоимости ремонта корпуса",
"function RepHullCostCalc(FullCost,FullSize,CurHP)",
"{",
"    //Вычисляем damageProc",
"    float FloatVar=100.0/FullSize*(FullSize-CurHP);",
"    //Целочисленное деление",
"    int IntVar=FullCost/40;",
"    float FloatVar2=IntVar;",
"    //Завершаем подсчёт",
"    FloatVar2=FloatVar2/100*FloatVar+10;",
"    //Приступаем к округлению до десятков",
"    //1) Банковское округление, 2) Целочисленное деление на 10, 3) Умножение на 10",
"    IntVar=round(FloatVar2);",
"    IntVar=IntVar/10;",
"    result=IntVar*10;",
"}",
"//Функция расчёта стоимости ремонта: mod == 7 - для обычных предметов, mod == 5 - для артефактов",
"function RepCostCalc(cost,durab,mod)",
"{",
"    //Производим целочисленные деления",
"    int IntVar=0;",
"    if(mod==7)IntVar=cost/20;",
"    if(mod==5)IntVar=cost/10;",
"    int IntVar2=cost/mod;",
"    //Записываем получившееся целое в \"дробную\" переменную для дальнейшей подстановки",
"    float FloatVar=IntVar2;",
"    //Важно наличие \"дробной\" переменной в начале вычисления для преобразования всей операции в дробный формат",
"    float FloatVar2=(FloatVar/100*(100-durab))+10;",
"    //Завершаем первичное вычисление",
"    FloatVar=FloatVar2+IntVar;",
"    //Приступаем к округлению до десятков",
"    //1) Банковское округление, 2) Целочисленное деление на 10, 3) Умножение на 10",
"    IntVar=round(FloatVar);",
"    IntVar=IntVar/10;",
"    IntVar=IntVar*10;",
"    //Если предмет полностью изношен, умножаем цену на 1.3",
"    if(durab<1)IntVar=round(1.3*IntVar);",
"    if(mod==7)result=IntVar;",
"    if(mod==5)result=IntVar*2;",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          570,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          42,
          "Total.Lines":          85,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=GAnswerData;",
"//Производим изъятие нодов из трюма и, если нужно, со склада",
"if(nod_cost>0)",
"{",
"    if(GetNodesFromShip(Player())>=nod_cost)GetNodesFromShip(Player(),nod_cost);",
"    else",
"    {",
"        for(i=1;i<ArrayDim(nodes_count_array);i=i+1)",
"        {",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))==nod_cost)",
"            {",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))>nod_cost)",
"            {",
"                temp_dword=GetItemFromStorage(FindItemInStorage(nodes_count_array[i]));",
"                ItemSize(temp_dword,ItemSize(temp_dword)-(nod_cost-GetNodesFromShip(Player())));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                AddItemToStorage(GetShipRuins(Player()),temp_dword);",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))<nod_cost)",
"            {",
"                nod_cost=nod_cost-(ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"            }",
"        }",
"    }",
"}",
"for(i=1;i<ArrayDim(items);i=i+1)",
"{",
"    cur_item=items[i];",
"    item_type=ItemType(cur_item);",
"    //tint==4 - чиним всё",
"    if(tint==4)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        ItemDurability(cur_item,100);",
"    }",
"    //tint==1 - чиним только нестандартное",
"    else if(tint==1)",
"    {",
"        if(item_type>=t_Weapon13 && item_type<=t_Weapon15)ItemDurability(cur_item,100);",
"        if(item_type==t_CustomWeapon)",
"        {",
"            if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"        }",
"    }",
"    //tint==2 - чиним только стандартное",
"    else if(tint==2 && (item_type>=t_Hull && item_type<=t_CustomWeapon) || item_type==t_Satellite)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        else",
"        {",
"            if(item_type<t_Weapon13 || item_type>t_Weapon15)",
"            {",
"                if(item_type!=t_CustomWeapon)ItemDurability(cur_item,100);",
"                else if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')!='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"            }",
"        }",
"    }",
"    //tint==3 - чиним только артефакты",
"    else if(tint==3 && item_type<t_Hull)",
"    {",
"        ItemDurability(cur_item,100);",
"        tstr='ArtRep';",
"    }",
"}",
"if(tint==1)cost=domik_wpn_cost;",
"else if(tint==2)cost=item_cost;",
"else if(tint==3)cost=art_cost;",
"else if(tint==4)cost=total;",
"ArrayClear(items);",
"ArrayClear(ship);",
"ShipMoney(Player(),ShipMoney(Player())-cost);",
"Sound('Sound.Repair');",
"",
"//Готовим ответные реплики",
"if(tstr=='ArtRep')AddText='</color>'+\"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Все артефакты теперь как новенькие!\";",
"else if(tstr=='ProbeRep')AddText='</color>'+\"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Все ваши зонды теперь как новенькие!\";",
"else if(!TrankRep)AddText='</color>'+\"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Зайдите на корабль и оцените результат. Ни единой царапины!\";",
"else AddText='</color>'+\"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Осмотрите транклюкатора - оцените результат. Ни единой царапины!\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          510,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          43,
          "Total.Lines":          110,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=0;",
"temp_dword=0;",
"//Проверяем количество нодов в трюме, а если не хватает, то чекаем ещё и склад",
"if(nod_cost && GetNodesFromShip(Player())<nod_cost)",
"{",
"    nodes_count_total=0;",
"    for(i=0; i<StorageItems(); i=i+1)",
"    {",
"        if(ItemType(StorageItems(i))!=t_Protoplasm)continue;",
"        if(StorageItemLocation(i)==GetShipRuins(Player()))",
"        {",
"            nodes_count_total=nodes_count_total+ItemSize(StorageItems(i));",
"            ArrayAdd(nodes_count_array,StorageItems(i));",
"        }",
"    }",
"    if((GetNodesFromShip(Player())+nodes_count_total)<nod_cost)",
"    {",
"        tint=1;",
"        temp_dword=1;",
"    }",
"}",
"if(ShipMoney(Player())<total)tint=1;",
"if(!item_cost && !art_cost)tint=2;",
"if(!item_cost && !domik_wpn_cost)tint=2;",
"if(!art_cost && !domik_wpn_cost)tint=2;",
"//Определяем вариативность ремонта",
"if(item_cost)AnsCount=AnsCount+1;",
"if(nod_cost)AnsCount=AnsCount+1;",
"if(art_cost)AnsCount=AnsCount+1;",
"",
"if(tint==0)",
"{",
"    InjectAnswer('Repair_SB_fix',\"Согласен оплатить полный ремонт\",4);",
"}",
"if(tint==1)",
"{",
"    AddDialogBlock(\"Согласен оплатить полный ремонт\",1);",
"    InjectAnswer('Repair_SB_fix',\"Согласен оплатить полный ремонт\",4);",
"}",
"if(item_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<item_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",2);",
"        if(AnsCount>1)InjectAnswer('Repair_SB_fix',\"Плачу только за стандартное оборудование\",2);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)",
"        {",
"            AddDialogBlock(\"Я согласен заплатить\",1);",
"            InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",2);",
"        }",
"        if(AnsCount>1)",
"        {",
"            AddDialogBlock(\"Плачу только за стандартное оборудование\",1);",
"            InjectAnswer('Repair_SB_fix',\"Плачу только за стандартное оборудование\",2);",
"        }",
"    }",
"}",
"if(nod_cost>0)",
"{",
"    //Маркер, что для нестандартного ремонта у игрока возможно не хватает нодов",
"    tint=temp_dword;",
"    if(ShipMoney(Player())<domik_wpn_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_SB_fix',\"Оплачиваю только нестандартный ремонт\",1);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)",
"        {",
"            AddDialogBlock(\"Я согласен заплатить\",1);",
"            InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",1);",
"        }",
"        if(AnsCount>1)",
"        {",
"            AddDialogBlock(\"Оплачиваю только нестандартный ремонт\",1);",
"            InjectAnswer('Repair_SB_fix',\"Оплачиваю только нестандартный ремонт\",1);",
"        }",
"    }",
"}",
"if(art_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<art_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",3);",
"        if(AnsCount>1)InjectAnswer('Repair_SB_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)",
"        {",
"            AddDialogBlock(\"Я согласен заплатить\",1);",
"            InjectAnswer('Repair_SB_fix',\"Я согласен заплатить\",3);",
"        }",
"        if(AnsCount>1)",
"        {",
"            AddDialogBlock(\"Пожалуй, ремонта артефактов будет вполне достаточно\",1);",
"            InjectAnswer('Repair_SB_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"        }",
"    }",
"}",
"InjectAnswer('Repair_SB_no',\"Спасибо, но это для меня неприемлемо\",0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          51,
          "Total.Lines":          63,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(ship);",
"ArrayClear(nodes_count_array);",
"",
"for(i=0; i<ShipPartners(Player()); i=i+1)",
"{//цикл, пока не закончатся все напарники рейнджеры",
"    cur_ship=ShipPartners(Player(),i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"for(i=0; i<PlayerPirates(); i=i+1)",
"{//цикл, пока не закончатся все напарники пираты",
"    cur_ship=PlayerPirates(i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"for(i=0; i<PlayerTranclucators(); i=i+1)",
"{//цикл, пока не закончатся все активные транки",
"    cur_ship=PlayerTranclucators(i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"for(i=0; i<ShipArts(Player()); i=i+1)",
"{//цикл, пока не закончатся все артефакты в трюме (ищем транков)",
"    cur_item=ShipArts(Player(),i);",
"    if(ItemType(cur_item)==t_ArtefactTranclucator)ArrayAdd(ship,ArtTranclucatorToShip(cur_item));",
"}",
"",
"item_cost=0;//стоимость оборудки",
"art_cost=0;//стоимость артов",
"domik_wpn_cost=0;//стоимость дом. оружия",
"nod_cost=0;//всего нодов",
"nod_cost_float=0;",
"discount=0;",
"discount_float=0;",
"cost=0;//общая стоимость",
"max_duration=0;",
"AddText='';",
"AddTextNodes='';",
"tstr='';",
"tstr2='';",
"AnsCount=0;",
"bad_equipments=0;//Переменная, обозначающая тяжёлые повреждения",
"bad_equipments_count=0;",
"total=0;",
"",
"//Установка длины \"дефисного разделителя\" и отступа в зависимости от выбранного в игре размера шрифта",
"if(!GetGameOptions('FontDialog'))",
"{",
"    DefSplt='</color>-----------------------------------------------------------';",
"    tstr2=CT('FormInfo.td_310')+CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog')==1)",
"{",
"    DefSplt='</color>------------------------------------------';",
"    tstr2=CT('FormInfo.td_312')+CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog')==2)",
"{",
"    DefSplt='</color>-------------------------------------------';",
"    tstr2=CT('FormInfo.td_324')+CT('FormInfo.align_right');",
"}",
"else",
"{",
"    DefSplt='</color>--------------------------------------';",
"    tstr2=CT('FormInfo.td_325')+CT('FormInfo.align_right');",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          140,
          "Pos.y":          190,
          "Parent":          -1,
          "#":          53,
          "Total.Lines":          39,
          "Code.Type":"Turn",
          "Code":          
          [
"InjectAnswer('Repair_PB_player',\"Чинить текущее оборудование\",0);",
"InjectAnswer('Repair_PB_player',\"Чинить оборудование в составе комплектаций\",1);",
"if(!ShipArts(Player()))AddDialogBlock(\"Чинить артефакты\",1);",
"InjectAnswer('Repair_PB_player',\"Чинить артефакты\",2);",
"//Ищем в трюме хотя бы один зонд",
"tint=0;",
"for(i=0; i<ShipItems(Player()); i=i+1)",
"{",
"    cur_item=ShipItems(Player(),i);",
"    //Пропускаем всё, кроме зондов",
"    if(ItemType(cur_item) != t_Satellite)continue;",
"    tint=1;",
"    break;",
"}",
"if(!tint)AddDialogBlock(\"Чинить зонды\",1);",
"InjectAnswer('Repair_PB_player',\"Чинить зонды\",3);",
"InjectAnswer('Repair_PB_player',\"Чинить всё\",4);",
"",
"if(ArrayDim(ship)-1)",
"{",
"    for(i=1; i<ArrayDim(ship); i=i+1)",
"    {",
"        cur_ship=ship[i];",
"        if(ShipTypeN(cur_ship) == t_Tranclucator)InjectAnswer('Repair_PB_ship',\"Чинить <ShipName(cur_ship)>\",cur_ship);",
"        else if(ShipTypeN(cur_ship) == t_Ranger)",
"        {",
"            if(ShipType(cur_ship) == 'RangerPirate' || ShipType(cur_ship) == 'RangerPirateExplorer')InjectAnswer('Repair_PB_ship',\"Чинить оборудование братана <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer')InjectAnswer('Repair_PB_ship',\"Чинить оборудование наёмника <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) != 'FemRanger')InjectAnswer('Repair_PB_ship',\"Чинить оборудование рейнджера <ShipName(cur_ship)>\",cur_ship);",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Pirate)",
"        {",
"            if(ShipType(cur_ship) == 'Rebel')InjectAnswer('Repair_PB_ship',\"Чинить оборудование повстанца <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer')InjectAnswer('Repair_PB_ship',\"Чинить оборудование наёмника <ShipName(cur_ship)>\",cur_ship);",
"            else InjectAnswer('Repair_PB_ship',\"Чинить оборудование братана <ShipName(cur_ship)>\",cur_ship);",
"        }",
"    }",
"}",
"InjectAnswer('GetBack',\"Сейчас пока ничего не надо\",-1);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          300,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          55,
          "Total.Lines":          3,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship=GAnswerData;",
"TrankRep=0;",
"if(ShipTypeN(cur_ship)==t_Tranclucator)TrankRep=1;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          56,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship=Player();"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          57,
          "Total.Lines":          72,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0;i<ShipItems(cur_ship);i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(i==0)",
"    {//0-й предмет это корпус",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        bad_equipments_count=bad_equipments_count+1;",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    if(!ItemIsInUse(cur_item))continue;//если оборудование используется в текущем сете",
"    if(ItemType(cur_item)>t_Hull && ItemType(cur_item)<t_Protoplasm)",
"    {",
"        bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"        bad_equipments_count=bad_equipments_count+1;",
"        if(ItemDurability(cur_item)<90)",
"        {//если износ оборудки больше 10%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//процент самой изношенной оборудки",
"}",
"for(i=0;i<ShipArts(cur_ship);i=i+1)",
"{//перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    if(!ItemIsInUse(cur_item))continue;//Пропуск если арт не в слоте",
"    bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"    bad_equipments_count=bad_equipments_count+1;",
"    if(ItemDurability(cur_item)<90)",
"    {//если износ арта больше 10%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          58,
          "Total.Lines":          78,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0;i<ShipItems(cur_ship);i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(i==0)",
"    {//0-й предмет это корпус",
"        bad_equipments_count=bad_equipments_count+1;",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;",
"    if(ItemType(cur_item)>t_Hull && ItemType(cur_item)<t_Protoplasm)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"            bad_equipments_count=bad_equipments_count+1;",
"        }",
"        if(ItemDurability(cur_item)<90)",
"        {//если износ оборудки больше 10%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//процент самой изношенной оборудки",
"}",
"for(i=0;i<ShipArts(cur_ship);i=i+1)",
"{//перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;//Пропуск если арт не в комплектации",
"    if(ItemIsInUse(cur_item))",
"    {",
"        bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"        bad_equipments_count=bad_equipments_count+1;",
"    }",
"    if(ItemDurability(cur_item)<90)",
"    {//если износ арта больше 10%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          420,
          "Pos.y":          220,
          "Parent":          -1,
          "#":          61,
          "Total.Lines":          108,
          "Code.Type":"Turn",
          "Code":          
          [
"//Расчёт скидки",
"//Банковское округление применяется к формуле, после чего добавляется ещё 1% (так это работает в оригинале)",
"//if((round(100.0*ShipStatus(Player(),1)/130)+1)<(GetShipPirateRank(Player())*5))discount=GetShipPirateRank(Player())*5;",
"//if((round(100.0*ShipStatus(Player(),1)/130)+1)>=(GetShipPirateRank(Player())*5))discount=round(100.0*ShipStatus(Player(),1)/130)+1;",
"discount=round(100.0*ShipStatus(Player(),1)/130)+1;",
"//Добавляем к скидке ещё по одному проценту за рейтинг выше 33 и 66",
"//В итоге получаем максимальный процент не 78%, а 80%, что выглядит солиднее (отключено)",
"//if(ShipStatus(Player(),1)>=33)discount=discount+1;",
"//if(ShipStatus(Player(),1)>=66)discount=discount+1;",
"",
"//Не менее одного нода на нестандартный ремонт",
"if(domik_wpn_cost)",
"{",
"    nod_cost=round(nod_cost_float);",
"    if(nod_cost<=0)nod_cost=1;",
"}",
"//Накладываем модификатор-скидку от ПБ",
"total=round(0.84*(item_cost+art_cost+domik_wpn_cost));",
"//Запоминаем общую цену без пиратской скидки",
"tint=total;",
"item_cost=round(0.84*item_cost);",
"art_cost=round(0.84*art_cost);",
"domik_wpn_cost=round(0.84*domik_wpn_cost);",
"tstr='';",
"variable=0;",
"//Вычитаем пиратскую скидку",
"discount_float=discount;",
"discount_float=discount_float/100*total;",
"total=round(total-discount_float);",
"//Скидка на обычное оборудование",
"discount_float=discount;",
"discount_float=discount_float/100*item_cost;",
"item_cost=round(item_cost-discount_float);",
"//Скидка на арты",
"discount_float=discount;",
"discount_float=discount_float/100*art_cost;",
"art_cost=round(art_cost-discount_float);",
"//Скидка на нестандартное оборудование",
"discount_float=discount;",
"discount_float=discount_float/100*domik_wpn_cost;",
"domik_wpn_cost=round(domik_wpn_cost-discount_float);",
"discount_float=0;",
"",
"if(bad_equipments/bad_equipments_count>=60)bad_equipments=1;",
"else bad_equipments=0;",
"//Готовим ответные реплики",
"if(!bad_equipments)",
"{",
"    if(cur_ship==Player())",
"    {",
"        AddText=\"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт твоего корабля тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\";",
"        AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии.\";",
"    }",
"    else if(!TrankRep)",
"    {",
"        if(ShipType(cur_ship)=='Merc')",
"        {",
"            AddText=\"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего наёмника тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"        else if(ShipType(cur_ship)=='Rebel')",
"        {",
"            AddText=\"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего чегевара тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"        else",
"        {",
"            AddText=\"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего братана тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"    }",
"    else",
"    {",
"        AddText=\"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт твоего транклюкатора тянет на <tint> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <discount><clr>%<clrEnd>.\";",
"        AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли в транке особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии.\";",
"    }",
"}",
"else",
"{",
"    if(cur_ship==Player())",
"    {",
"        AddText=\"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только тебя на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <tint> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <discount><clr>%<clrEnd>.\";",
"        AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии.\";",
"    }",
"    else if(!TrankRep)",
"    {",
"        if(ShipType(cur_ship)=='Merc')",
"        {",
"            AddText=\"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего наёмника на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <tint> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"        else if(ShipType(cur_ship)=='Rebel')",
"        {",
"            AddText=\"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего чегевара на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <tint> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"        else",
"        {",
"            AddText=\"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего братана на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <tint> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <discount><clr>%<clrEnd>.\";",
"            AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии.\";",
"        }",
"    }",
"    else",
"    {",
"        AddText=\"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только он у тебя ещё от звёздного ветра не рассыпался?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <tint> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <discount><clr>%<clrEnd>.\";",
"        AddTextNodes=\"</color>И кстати, чуть не забыл! Ребята нашли в транке особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии.\";",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          510,
          "Pos.y":          220,
          "Parent":          -1,
          "#":          65,
          "Total.Lines":          89,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=0;",
"temp_dword=0;",
"//Проверяем количество нодов в трюме, а если не хватает, то чекаем ещё и склад",
"if(nod_cost>0 && GetNodesFromShip(Player())<nod_cost)",
"{",
"    nodes_count_total=0;",
"    for(i=0;i<StorageItems();i=i+1)",
"    {",
"        if(ItemType(StorageItems(i))!=t_Protoplasm)continue;",
"        if(StorageItemLocation(i)==GetShipRuins(Player()))",
"        {",
"            nodes_count_total=nodes_count_total+ItemSize(StorageItems(i));",
"            ArrayAdd(nodes_count_array,StorageItems(i));",
"        }",
"    }",
"    if((GetNodesFromShip(Player())+nodes_count_total)<nod_cost)",
"    {",
"        tint=1;",
"        temp_dword=1;",
"    }",
"}",
"if(ShipMoney(Player())<total)tint=1;",
"if(item_cost==0 && art_cost==0)tint=2;",
"if(item_cost==0 && domik_wpn_cost==0)tint=2;",
"if(art_cost==0 && domik_wpn_cost==0)tint=2;",
"//Определяем вариативность ремонта",
"if(item_cost>0)AnsCount=AnsCount+1;",
"if(nod_cost>0)AnsCount=AnsCount+1;",
"if(art_cost>0)AnsCount=AnsCount+1;",
"",
"if(tint==0)InjectAnswer('Repair_PB_fix',\"Согласен оплатить полный ремонт\",4);",
"if(tint==1)",
"{",
"    AddDialogBlock(\"Согласен оплатить полный ремонт\",1);",
"    InjectAnswer('Repair_PB_fix',\"Согласен оплатить полный ремонт\",4);",
"}",
"if(item_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<item_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",2);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Почините стандартное оборудование\",2);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"По рукам!\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",2);",
"        if(AnsCount>1)AddDialogBlock(\"Почините стандартное оборудование\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Почините стандартное оборудование\",2);",
"    }",
"}",
"if(nod_cost>0)",
"{",
"    //Маркер, что для нестандартного ремонта у игрока возможно не хватает нодов",
"    tint=temp_dword;",
"    if(ShipMoney(Player())<domik_wpn_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Плачу только за особые пушки\",1);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"По рукам!\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",1);",
"        if(AnsCount>1)AddDialogBlock(\"Плачу только за особые пушки\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Плачу только за особые пушки\",1);",
"    }",
"}",
"if(art_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<art_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",3);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"По рукам!\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_PB_fix',\"По рукам!\",3);",
"        if(AnsCount>1)AddDialogBlock(\"Пожалуй, ремонта артефактов будет вполне достаточно\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_PB_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"    }",
"}",
"InjectAnswer('Repair_PB_no',\"Спасибо, но я передумал\",0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          570,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          67,
          "Total.Lines":          80,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=GAnswerData;",
"//Производим изъятие нодов из трюма и, если нужно, со склада",
"if(nod_cost>0)",
"{",
"    if(GetNodesFromShip(Player())>=nod_cost)GetNodesFromShip(Player(),nod_cost);",
"    else",
"    {",
"        for(i=1;i<ArrayDim(nodes_count_array);i=i+1)",
"        {",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))==nod_cost)",
"            {",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))>nod_cost)",
"            {",
"                temp_dword=GetItemFromStorage(FindItemInStorage(nodes_count_array[i]));",
"                ItemSize(temp_dword,ItemSize(temp_dword)-(nod_cost-GetNodesFromShip(Player())));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                AddItemToStorage(GetShipRuins(Player()),temp_dword);",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))<nod_cost)",
"            {",
"                nod_cost=nod_cost-(ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"            }",
"        }",
"    }",
"}",
"for(i=1;i<ArrayDim(items);i=i+1)",
"{",
"    cur_item=items[i];",
"    item_type=ItemType(cur_item);",
"    //tint==4 - чиним всё",
"    if(tint==4)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        ItemDurability(cur_item,100);",
"    }",
"    //tint==1 - чиним только нестандартное",
"    else if(tint==1)",
"    {",
"        if(item_type>=t_Weapon13 && item_type<=t_Weapon15)ItemDurability(cur_item,100);",
"        if(item_type==t_CustomWeapon)",
"        {",
"            if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"        }",
"    }",
"    //tint==2 - чиним только стандартное",
"    else if(tint==2 && (item_type>=t_Hull && item_type<=t_CustomWeapon) || item_type==t_Satellite)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        else",
"        {",
"            if(item_type<t_Weapon13 || item_type>t_Weapon15)",
"            {",
"                if(item_type!=t_CustomWeapon)ItemDurability(cur_item,100);",
"                else if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')!='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"            }",
"        }",
"    }",
"    //tint==3 - чиним только артефакты",
"    else if(tint==3 && item_type<t_Hull)ItemDurability(cur_item,100);",
"}",
"if(tint==1)cost=domik_wpn_cost;",
"else if(tint==2)cost=item_cost;",
"else if(tint==3)cost=art_cost;",
"else if(tint==4)cost=total;",
"ArrayClear(items);",
"ArrayClear(ship);",
"ShipMoney(Player(),ShipMoney(Player())-cost);",
"Sound('Sound.Repair');",
"",
"//Готовим ответные реплики",
"if(tstr=='ArtRep' || tstr=='ProbeRep')AddText='</color>'+\"Ну вот и славно! Твои бабки мы уже списали, а ремонт закончим с минуты на минуту.<br>Ступай на корабль, <Player> - принимай работу!\";",
"else if(!TrankRep)AddText='</color>'+\"Ну вот и славно! Твои бабки мы уже списали, а ремонт закончим с минуты на минуту.<br>Ступай на корабль, <Player> - принимай работу!\";",
"else AddText='</color>'+\"Ну вот и славно! Твои бабки мы уже списали, а ремонт закончим с минуты на минуту.<br>Иди проверь транка, <Player> - оцени работу!\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          89,
          "Total.Lines":          43,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"if(GAnswerData == 2)",
"{",
"    //Перебор всех артов",
"    for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipArts(cur_ship, i);",
"        if(!ItemCanBeBroken(cur_item)) continue;//Пропуск если арт не может сломаться",
"        //if(ItemIsInUse(cur_item))continue;//Пропуск если арт стоит в слоте (выключен)",
"",
"        //Если износ артефакта не менее 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"    }",
"    if(!art_cost) AddText = '</color>' + \"Сейчас посмотрим...<br>...<br>Все ваши артефакты в отличном состоянии и не требуют ремонта.\";",
"}",
"else",
"{",
"    //Ищем в трюме зонды",
"    for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipItems(cur_ship, i);",
"        //Пропускаем всё, кроме зондов",
"        if(ItemType(cur_item) != t_Satellite) continue;",
"",
"        //Если зонд изношен не менее, чем на 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит считаем как для оборудования",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"    }",
"    if(!art_cost) AddText = '</color>' + \"Сейчас посмотрим...<br>...<br>Все ваши зонды в отличном состоянии и не требуют ремонта.\";",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          360,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          93,
          "Total.Lines":          14,
          "Code.Type":"Turn",
          "Code":          
          [
"if(GAnswerData == 2)",
"{",
"    art_cost = round(0.84 * art_cost);",
"    tstr = 'ArtRep';",
"",
"    AddText = '</color>' + \"Сейчас посмотрим...<br>...<br>Так, так... Есть небольшие поломки... Ого, а вот это уже посерьёзнее! Но в целом ничего страшного.<br>Мы легко восстановим все ваши артефакты всего за <art_cost> cr. Договорились?\";",
"}",
"else",
"{",
"    tstr = 'ProbeRep';",
"",
"    AddText = '</color>' + \"Сейчас посмотрим...<br>...<br>Так, так... Есть небольшие поломки... Ого, а вот это уже посерьёзнее! Но в целом ничего страшного.<br>Мы легко восстановим все ваши зонды всего за <art_cost> cr. Договорились?\";",
"}",
"total = art_cost;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          390,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          95,
          "Total.Lines":          11,
          "Code.Type":"Turn",
          "Code":          
          [
"//Проверяем, хватает ли у игрока денег",
"tint = 0;",
"if(ShipMoney(Player()) < total) tint = 1;",
"",
"if(!tint) InjectAnswer('Repair_SB_fix', \"Я согласен заплатить\", 4);",
"else",
"{",
"    AddDialogBlock(\"Я согласен заплатить\", 1);",
"    InjectAnswer('Repair_SB_fix', \"Я согласен заплатить\", 4);",
"}",
"InjectAnswer('Repair_SB_no', \"Спасибо, но это для меня неприемлемо\", 0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          420,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          100,
          "Total.Lines":          7,
          "Code.Type":"Turn",
          "Code":          
          [
"if(cur_ship == Player()) AddText = \"</color>Ваш корабль, <Player>,\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship) == 'Merc') AddText = \"</color>Корабль наёмника\";",
"    else AddText = \"</color>Корабль вашего напарника\";",
"}",
"else AddText = \"</color>Ваш транклюкатор\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          110,
          "Parent":          -1,
          "#":          103,
          "Total.Lines":          82,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship, cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item) > -1)",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет - это корпус",
"    if(!i)",
"    {",
"        bad_equipments_count = bad_equipments_count + 1;",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship);",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    //if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue;",
"    if((ItemType(cur_item) >= t_FuelTanks && ItemType(cur_item) <= t_CustomWeapon) || ItemType(cur_item) == t_Satellite)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"            bad_equipments_count = bad_equipments_count + 1;",
"        }",
"        //Если износ оборудки больше 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит, считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable;",
"            ArrayAdd(items, cur_item);",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                //Отдельно считаем стоимость ремонта дом. оружия",
"                domik_wpn_cost = domik_wpn_cost + variable;",
"                nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                item_cost = item_cost - variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    //Отдельно считаем стоимость ремонта дом. оружия",
"                    domik_wpn_cost = domik_wpn_cost + variable;",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"//Перебор всех артов",
"for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipArts(cur_ship, i);",
"    if(!ItemCanBeBroken(cur_item)) continue; //Пропуск если арт не может сломаться",
"    bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"    bad_equipments_count = bad_equipments_count + 1;",
"    //Если износ арта больше 10%",
"    if(ItemDurability(cur_item) < 90)",
"    {",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"        art_cost = art_cost + variable;",
"        ArrayAdd(items, cur_item);",
"    }",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          105,
          "Total.Lines":          9,
          "Code.Type":"Turn",
          "Code":          
          [
"//Готовим ответные реплики, снова",
"if(cur_ship==Player())AddText='</color>'+\"Ну, это вам сейчас кажется, что неприемлемо. А как сядут на хвост пираты, пробьют топливный бак, и двигатель откажет в бою... Что тогда станете делать, <Player>?<br>Лучше починить всё сразу, чтобы не попасть в такую ситуацию.\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc' && bad_equipments==0)AddText='</color>'+\"Оно, <Player>, конечно, может и разумно... Ну подумаешь, наёмник, чего на него лишние деньги тратить? Вот только в перестрелке надёжнее этих ребят вы вряд ли кого встретите, так что настоятельно рекомендую пересмотреть инвестиционные приоритеты.\";",
"    else if(ShipType(cur_ship)=='Merc' && bad_equipments==1)AddText='</color>'+\"Даром что наёмник, но ведь он живой гуманоид, <Player>! Неужели вам ничуть не жаль своих телохранителей?<br>Ну не о нём, так о себе подумайте, ведь наёмник - ваш надёжный щит! Вот сядут вам на хвост пираты... А, впрочем, чего я на вас время трачу...\";",
"    else AddText='</color>'+\"Очень неразумно экономить на своём напарнике, <Player>. Вот сядут вам на хвост пираты - напарника под удар подставить может и удастся, но так ведь потом и до вас очередь дойдёт! А представьте, что будет, если напарник из той передряги всё же выберется?<br>Уж лучше слегка переплатить за ремонт, чем попасть в такую ситуацию.\";",
"}",
"else AddText='</color>'+\"Напрасно вы отказываетесь от ремонта своего транклюкатора. Отличная машина, а главное - полезная и послушная. Он ведь вас и в бою прикроет, и вещи со всей системы для вас соберёт...<br>Не цените вы, <Player>, хорошей робототехники. Наверное, потому и рейнджер.\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          106,
          "Total.Lines":          12,
          "Code.Type":"Turn",
          "Code":          
          [
"AddText='';",
"AddTextNodes='';",
"DefSplt='';",
"TrankRep=0;",
"AnsCount=0;",
"bad_equipments=0;",
"bad_equipments_count=0;",
"nod_cost=0;",
"nod_cost_float=0;",
"temp_dword=0;",
"tstr='';",
"tstr2='';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          420,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          109,
          "Total.Lines":          8,
          "Code.Type":"Turn",
          "Code":          
          [
"if(cur_ship==Player())AddText=\"</color>Твоя \\\"птичка\\\" в отличном состоянии, <Player>, ремонт ей не нужен.\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc')AddText=\"</color>Корабль твоего наёмника в полном порядке, ремонт ему не требуется.\";",
"    else if(ShipType(cur_ship)=='Rebel')AddText=\"</color>Корабль твоего чегевара в полном порядке, ремонт требуется только его мозгам.\";",
"    else AddText=\"</color>Корабль твоего братана в полном порядке. Прилетайте, как из-под капота застучит, хе-хе.\";",
"}",
"else AddText=\"</color>Твой транк и так в отличном состоянии, ремонт ему не нужен.\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          250,
          "Parent":          -1,
          "#":          112,
          "Total.Lines":          74,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0; i<ShipItems(cur_ship); i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(!i)",
"    {//0-й предмет - это корпус",
"        bad_equipments_count=bad_equipments_count+1;",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    //if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;",
"    if((ItemType(cur_item)>=t_FuelTanks && ItemType(cur_item)<=t_CustomWeapon) || ItemType(cur_item)==t_Satellite)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"            bad_equipments_count=bad_equipments_count+1;",
"        }",
"        if(ItemDurability(cur_item)<90)",
"        {//Если износ оборудки больше 10%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//Продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//Заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//Отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//Процент самой изношенной оборудки",
"}",
"for(i=0; i<ShipArts(cur_ship); i=i+1)",
"{//Перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"    bad_equipments_count=bad_equipments_count+1;",
"    if(ItemDurability(cur_item)<90)",
"    {//Если износ арта больше 10%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          340,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          113,
          "Total.Lines":          42,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//Очищаем массив предметов",
"if(GAnswerData==2)",
"{",
"    for(i=0;i<ShipArts(cur_ship);i=i+1)",
"    {//Перебор всех артов",
"        cur_item=ShipArts(cur_ship,i);",
"        if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"        //if(ItemIsInUse(cur_item))continue;//Пропуск если арт стоит в слоте (выключен)",
"",
"        //Если износ артефакта не менее 10%",
"        if(ItemDurability(cur_item)<90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"            art_cost=art_cost+variable;",
"            ArrayAdd(items,cur_item);",
"        }",
"    }",
"    if(!art_cost)AddText='</color>'+\"А ну-ка сейчас заценим...<br>...<br>Похоже, что все твои артефакты в полном порядке. Возвращайся, как до чёрных дыр затаскаешь, хе-хе.\";",
"}",
"else",
"{",
"    //Ищем в трюме зонды",
"    for(i=0;i<ShipItems(cur_ship);i=i+1)",
"    {",
"        cur_item=ShipItems(cur_ship,i);",
"        //Пропускаем всё, кроме зондов",
"        if(ItemType(cur_item) != t_Satellite)continue;",
"",
"        //Если зонд изношен не менее, чем на 10%",
"        if(ItemDurability(cur_item)<90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит считаем как для оборудования",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            art_cost=art_cost+variable;",
"            ArrayAdd(items,cur_item);",
"        }",
"    }",
"    if(!art_cost)AddText='</color>'+\"А ну-ка сейчас заценим...<br>...<br>Похоже, что все твои зонды в полном порядке. Возвращайся, как на лету рассыпаться начнут, хе-хе.\";",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          190,
          "Parent":          -1,
          "#":          116,
          "Total.Lines":          11,
          "Code.Type":"Turn",
          "Code":          
          [
"//Проверяем, хватает ли у игрока денег",
"tint=0;",
"if(ShipMoney(Player())<total)tint=1;",
"",
"if(!tint)InjectAnswer('Repair_PB_fix',\"По рукам!\",4);",
"else",
"{",
"    AddDialogBlock(\"По рукам!\",1);",
"    InjectAnswer('Repair_PB_fix',\"По рукам!\",4);",
"}",
"InjectAnswer('Repair_PB_no',\"Спасибо, но я передумал\",0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          370,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          117,
          "Total.Lines":          30,
          "Code.Type":"Turn",
          "Code":          
          [
"//Расчёт скидки",
"//Банковское округление применяется к формуле, после чего добавляется ещё 1% (так это работает в оригинале)",
"//if((round(100.0*ShipStatus(Player(),1)/130)+1)<(GetShipPirateRank(Player())*5))discount=GetShipPirateRank(Player())*5;",
"//if((round(100.0*ShipStatus(Player(),1)/130)+1)>=(GetShipPirateRank(Player())*5))discount=round(100.0*ShipStatus(Player(),1)/130)+1;",
"discount=round(100.0*ShipStatus(Player(),1)/130)+1;",
"//Добавляем к скидке ещё по одному проценту за рейтинг выше 33 и 66",
"//В итоге получаем максимальный процент не 78%, а 80%, что выглядит солиднее (отключено)",
"//if(ShipStatus(Player(),1)>=33)discount=discount+1;",
"//if(ShipStatus(Player(),1)>=66)discount=discount+1;",
"",
"if(GAnswerData==2)",
"{",
"    if(ShipPilotRace(Player())==0)AddText=\"</color>малок\";",
"    else if(ShipPilotRace(Player())==1)AddText=\"</color>пеленг\";",
"    else if(ShipPilotRace(Player())==2)AddText=\"</color>человек\";",
"    else if(ShipPilotRace(Player())==3)AddText=\"</color>фэянин\";",
"    else AddText=\"</color>гаалец\";",
"",
"    art_cost=round(0.84*art_cost);",
"    tstr='ArtRep';",
"}",
"else tstr='ProbeRep';",
"total=art_cost;",
"tint=total;",
"//Вычитаем пиратскую скидку",
"discount_float=discount;",
"discount_float=discount_float/100*total;",
"total=round(total-discount_float);",
"discount_float=0;",
"tstr='ArtRep';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          540,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          120,
          "Total.Lines":          13,
          "Code.Type":"Turn",
          "Code":          
          [
"AddText='';",
"AddTextNodes='';",
"DefSplt='';",
"TrankRep=0;",
"AnsCount=0;",
"bad_equipments=0;",
"nod_cost=0;",
"nod_cost_float=0;",
"bad_equipments=0;",
"bad_equipments_count=0;",
"temp_dword=0;",
"tstr='';",
"tstr2='';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          124,
          "Total.Lines":          9,
          "Code.Type":"Turn",
          "Code":          
          [
"//Готовим ответные реплики, снова",
"if(cur_ship==Player())AddText='</color>'+\"Ну ты и жлобяра, <Player>, зажал бабки на ремонт!<br>А ну как в следующей системе на жестянок напорешься? Отделают тебя электроники как Сидорову козу, вот увидишь!\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc')AddText='</color>'+\"Понимаю тебя, <Player>, пусть лучше эти наёмники сами себя ремонтом и обеспечивают, чай не нищие.<br>Но если вдруг передумаешь - милости просим в рем-док. Уж нам с ребятами лишние кредиты точно не помешают.\";",
"    else if(ShipType(cur_ship)=='Rebel')AddText='</color>'+\"Я, <Player>, конечно, и сам этих чегеваров не перевариваю, уж больно они все на своих идеях двинутые. Но ты всё же подумай ещё разок - а ну как этот либертарианец в бою пригодится? Так-то они парни горячие.\";",
"    else AddText='</color>'+\"Не по понятиям, <Player>, братану в нужде отказывать! Вот сегодня ты его на ремонт прокатишь, а завтра что? А я тебе скажу, что завтра. Завтра, <Player>, ты один, уже без братана, с голой кормой ввяжешься в неравный бой, да в том же бою безвестно и сгинешь!<br>Подумай-ка ещё разок - надо оно тебе, или может лучше сейчас переплатить, чем потом с космической пылью промеж звёзд хороводы накручивать.\";",
"}",
"else AddText='</color>'+\"Эх, <Player>! Не знаешь ты цены хорошему транклюкатору...<br>Ведь это же настоящее чудо инженерной техники! Вот сам посуди: денег за службу не требует, собранные вещички сам без базара отдаёт... Не напарник - сказка.<br>Чинил бы лучше, пока он у тебя кукухой не тронулся, да к ближайшей звезде на полной скорости не рванул!\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          120,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          135,
          "Total.Lines":          64,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(ship);",
"ArrayClear(nodes_count_array);",
"",
"//Цикл, пока не закончатся все напарники рейнджеры",
"for(i=0; i<ShipPartners(Player()); i=i+1)",
"{",
"    cur_ship=ShipPartners(Player(),i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"for(i=0; i<PlayerPirates(); i=i+1)",
"{//цикл, пока не закончатся все напарники пираты",
"    cur_ship=PlayerPirates(i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"//Цикл, пока не закончатся все активные транки",
"for(i=0; i<PlayerTranclucators(); i=i+1)",
"{",
"    cur_ship=PlayerTranclucators(i);",
"    if(GetShipRuins(cur_ship)==GetShipRuins(Player()))ArrayAdd(ship,cur_ship);",
"}",
"//Цикл, пока не закончатся все артефакты в трюме (ищем транков)",
"for(i=0; i<ShipArts(Player()); i=i+1)",
"{",
"    cur_item=ShipArts(Player(),i);",
"    if(ItemType(cur_item)==t_ArtefactTranclucator)ArrayAdd(ship,ArtTranclucatorToShip(cur_item));",
"}",
"",
"item_cost=0;//стоимость оборудки",
"art_cost=0;//стоимость артов",
"domik_wpn_cost=0;//стоимость дом. оружия",
"nod_cost=0;//всего нодов",
"nod_cost_float=0;",
"cost=0;//общая стоимость",
"max_duration=0;",
"AddText='';",
"AddTextNodes='';",
"tstr='';",
"tstr2='';",
"AnsCount=0;",
"bad_equipments=0;//Переменная, обозначающая тяжёлые повреждения",
"bad_equipments_count=0;",
"total=0;",
"",
"//Установка длины \"дефисного разделителя\" и отступа в зависимости от выбранного в игре размера шрифта",
"if(!GetGameOptions('FontDialog'))",
"{",
"    DefSplt='</color>-----------------------------------------------------------';",
"    tstr2=CT('FormInfo.td_310')+CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog')==1)",
"{",
"    DefSplt='</color>------------------------------------------';",
"    tstr2=CT('FormInfo.td_312')+CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog')==2)",
"{",
"    DefSplt='</color>-------------------------------------------';",
"    tstr2=CT('FormInfo.td_324')+CT('FormInfo.align_right');",
"}",
"else",
"{",
"    DefSplt='</color>--------------------------------------';",
"    tstr2=CT('FormInfo.td_325')+CT('FormInfo.align_right');",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          140,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          137,
          "Total.Lines":          41,
          "Code.Type":"Turn",
          "Code":          
          [
"InjectAnswer('Repair_TC_player',\"Чинить текущее оборудование\",0);",
"InjectAnswer('Repair_TC_player',\"Чинить оборудование в составе комплектаций\",1);",
"if(!ShipArts(Player()))AddDialogBlock(\"Чинить артефакты\",1);",
"InjectAnswer('Repair_TC_player',\"Чинить артефакты\",2);",
"",
"//Ищем в трюме хотя бы один зонд",
"tint=0;",
"for(i=0; i<ShipItems(Player()); i=i+1)",
"{",
"    cur_item=ShipItems(Player(),i);",
"    //Пропускаем всё, кроме зондов",
"    if(ItemType(cur_item) != t_Satellite)continue;",
"    tint=1;",
"    break;",
"}",
"if(!tint)AddDialogBlock(\"Чинить зонды\",1);",
"InjectAnswer('Repair_TC_player',\"Чинить зонды\",3);",
"InjectAnswer('Repair_TC_player',\"Чинить всё\",4);",
"",
"if(ArrayDim(ship)-1)",
"{",
"    for(i=1; i<ArrayDim(ship); i=i+1)",
"    {",
"        cur_ship=ship[i];",
"        if(ShipTypeN(cur_ship) == t_Tranclucator) InjectAnswer('Repair_TC_ship',\"Чинить <ShipName(cur_ship)>\",cur_ship);",
"        else if(ShipTypeN(cur_ship) == t_Ranger)",
"        {",
"            if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer') InjectAnswer('Repair_TC_ship',\"Чинить оборудование наёмника <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) == 'RangerPirate' || ShipType(cur_ship) == 'RangerPirateExplorer') InjectAnswer('Repair_TC_ship',\"Чинить оборудование братана <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) == 'FemRanger') InjectAnswer('Repair_TC_ship',\"Чинить оборудование спецагента <ShipName(cur_ship)>\",cur_ship);",
"            else InjectAnswer('Repair_TC_ship',\"Чинить оборудование рейнджера <ShipName(cur_ship)>\",cur_ship);",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Pirate)",
"        {",
"            if(ShipType(cur_ship) == 'Rebel') InjectAnswer('Repair_TC_ship',\"Чинить оборудование повстанца <ShipName(cur_ship)>\",cur_ship);",
"            else if(ShipType(cur_ship) == 'Merc' || ShipType(cur_ship) == 'Freelancer') InjectAnswer('Repair_TC_ship',\"Чинить оборудование наёмника <ShipName(cur_ship)>\",cur_ship);",
"            else InjectAnswer('Repair_TC_ship',\"Чинить оборудование братана <ShipName(cur_ship)>\",cur_ship);",
"        }",
"    }",
"}",
"InjectAnswer('GetBack',\"Я передумал, ремонт мне не нужен\",-1);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          140,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship=Player();"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          260,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          144,
          "Total.Lines":          3,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship=GAnswerData;",
"TrankRep=0;",
"if(ShipTypeN(cur_ship)==t_Tranclucator)TrankRep=1;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          290,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          146,
          "Total.Lines":          72,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0;i<ShipItems(cur_ship);i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(i==0)",
"    {//0-й предмет это корпус",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        bad_equipments_count=bad_equipments_count+1;",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    if(!ItemIsInUse(cur_item))continue;//если оборудование используется в текущем сете",
"    if(ItemType(cur_item)>t_Hull && ItemType(cur_item)<t_Protoplasm)",
"    {",
"        bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"        bad_equipments_count=bad_equipments_count+1;",
"        if(ItemDurability(cur_item)<100)",
"        {//если износ оборудки больше 0%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//процент самой изношенной оборудки",
"}",
"for(i=0;i<ShipArts(cur_ship);i=i+1)",
"{//перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    if(!ItemIsInUse(cur_item))continue;//Пропуск если арт не в слоте",
"    bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"    bad_equipments_count=bad_equipments_count+1;",
"    if(ItemDurability(cur_item)<100)",
"    {//если износ арта больше 0%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          310,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          147,
          "Total.Lines":          42,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//Очищаем массив предметов",
"if(GAnswerData==2)",
"{",
"    for(i=0;i<ShipArts(cur_ship);i=i+1)",
"    {//Перебор всех артов",
"        cur_item=ShipArts(cur_ship,i);",
"        if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"        //if(ItemIsInUse(cur_item))continue;//Пропуск если арт стоит в слоте (выключен)",
"",
"        //Если артефакт хотя бы чуть-чуть изношен",
"        if(ItemDurability(cur_item)<100)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"            art_cost=art_cost+variable;",
"            ArrayAdd(items,cur_item);",
"        }",
"    }",
"    if(!art_cost)AddText='</color>'+\"Так-так, проведём-ка техосмотр...<br>...<br>Похоже, все ваши артефакты в отличной кондиции, и ремонта не требуют.\";",
"}",
"else",
"{",
"    //Ищем в трюме зонды",
"    for(i=0;i<ShipItems(cur_ship);i=i+1)",
"    {",
"        cur_item=ShipItems(cur_ship,i);",
"        //Пропускаем всё, кроме зондов",
"        if(ItemType(cur_item) != t_Satellite)continue;",
"",
"        //Если зонд хотя бы чуть-чуть изношен",
"        if(ItemDurability(cur_item)<100)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит считаем как для оборудования",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            art_cost=art_cost+variable;",
"            ArrayAdd(items,cur_item);",
"        }",
"    }",
"    if(!art_cost)AddText='</color>'+\"Так-так, проведём-ка техосмотр...<br>...<br>Похоже, все ваши зонды в отличной кондиции, и ремонта не требуют.\";",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          360,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          150,
          "Total.Lines":          15,
          "Code.Type":"Turn",
          "Code":          
          [
"if(GAnswerData==2)",
"{",
"    art_cost=round(1.15*art_cost);",
"    tstr='ArtRep';",
"",
"    AddText='</color>'+\"Так-так, проведём-ка техосмотр...<br>...<br>Хмм, ну, вроде, ничего серьёзного. Всё устраним и восстановим за <art_cost> cr.<br>Могли бы дешевле, да только за лицензию с нас \\\"научники\\\" и так по три шкуры дерут - жлобяры!\";",
"}",
"else",
"{",
"    art_cost=round(0.80*art_cost);",
"    tstr='ProbeRep';",
"",
"    AddText='</color>'+\"Так-так, проведём-ка техосмотр...<br>...<br>Хмм, ну, вроде, ничего серьёзного. Всё устраним и восстановим за <art_cost> cr.<br>Устроит вас такая цена?\";",
"}",
"total=art_cost;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          380,
          "Pos.y":          470,
          "Parent":          -1,
          "#":          152,
          "Total.Lines":          11,
          "Code.Type":"Turn",
          "Code":          
          [
"//Проверяем, хватает ли у игрока денег",
"tint=0;",
"if(ShipMoney(Player())<total)tint=1;",
"",
"if(!tint)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",4);",
"else",
"{",
"    AddDialogBlock(\"Я согласен заплатить\",1);",
"    InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",4);",
"}",
"InjectAnswer('Repair_TC_no',\"Спасибо, но цена уж слишком велика\",0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          410,
          "Pos.y":          530,
          "Parent":          -1,
          "#":          153,
          "Total.Lines":          74,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0; i<ShipItems(cur_ship); i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(!i)",
"    {//0-й предмет - это корпус",
"        bad_equipments_count=bad_equipments_count+1;",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    //if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;",
"    if((ItemType(cur_item)>=t_FuelTanks && ItemType(cur_item)<=t_CustomWeapon) || ItemType(cur_item)==t_Satellite)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"            bad_equipments_count=bad_equipments_count+1;",
"        }",
"        if(ItemDurability(cur_item)<100)",
"        {//если износ оборудки больше 0%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит, считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//процент самой изношенной оборудки",
"}",
"for(i=0; i<ShipArts(cur_ship); i=i+1)",
"{//перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"    bad_equipments_count=bad_equipments_count+1;",
"    if(ItemDurability(cur_item)<100)",
"    {//если износ арта больше 0%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          590,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          157,
          "Total.Lines":          85,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=GAnswerData;",
"//Производим изъятие нодов из трюма и, если нужно, со склада",
"if(nod_cost>0)",
"{",
"    if(GetNodesFromShip(Player())>=nod_cost)GetNodesFromShip(Player(),nod_cost);",
"    else",
"    {",
"        for(i=1;i<ArrayDim(nodes_count_array);i=i+1)",
"        {",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))==nod_cost)",
"            {",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))>nod_cost)",
"            {",
"                temp_dword=GetItemFromStorage(FindItemInStorage(nodes_count_array[i]));",
"                ItemSize(temp_dword,ItemSize(temp_dword)-(nod_cost-GetNodesFromShip(Player())));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                AddItemToStorage(GetShipRuins(Player()),temp_dword);",
"                break;",
"            }",
"            if((ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()))<nod_cost)",
"            {",
"                nod_cost=nod_cost-(ItemSize(nodes_count_array[i])+GetNodesFromShip(Player()));",
"                GetNodesFromShip(Player(),GetNodesFromShip(Player()));",
"                FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"            }",
"        }",
"    }",
"}",
"for(i=1; i<ArrayDim(items); i=i+1)",
"{",
"    cur_item=items[i];",
"    item_type=ItemType(cur_item);",
"    //tint==4 - чиним всё",
"    if(tint==4)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        ItemDurability(cur_item,100);",
"    }",
"    //tint==1 - чиним только нестандартное",
"    else if(tint==1)",
"    {",
"        if(item_type>=t_Weapon13 && item_type<=t_Weapon15)ItemDurability(cur_item,100);",
"        if(item_type==t_CustomWeapon)",
"        {",
"            if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"        }",
"    }",
"    //tint==2 - чиним только стандартное",
"    else if(tint==2 && (item_type>=t_Hull && item_type<=t_CustomWeapon) || item_type==t_Satellite)",
"    {",
"        if(item_type==t_Hull)HullHP(cur_ship,ItemSize(ShipItems(cur_ship,0)));",
"        else",
"        {",
"            if(item_type<t_Weapon13 || item_type>t_Weapon15)",
"            {",
"                if(item_type!=t_CustomWeapon)ItemDurability(cur_item,100);",
"                else if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')!='NotSoldAndNodeRepair')ItemDurability(cur_item,100);",
"            }",
"        }",
"    }",
"    //tint==3 - чиним только артефакты",
"    else if(tint==3 && item_type<t_Hull)",
"    {",
"        ItemDurability(cur_item,100);",
"        tstr='ArtRep';",
"    }",
"}",
"if(tint==1)cost=domik_wpn_cost;",
"else if(tint==2)cost=item_cost;",
"else if(tint==3)cost=art_cost;",
"else if(tint==4)cost=total;",
"ArrayClear(items);",
"ArrayClear(ship);",
"ShipMoney(Player(),ShipMoney(Player())-cost);",
"Sound('Sound.Repair');",
"",
"//Готовим ответные реплики",
"if(tstr=='ArtRep')AddText='</color>'+\"От всей души благодарю, что не отказались, увидев цену!<br>Все ваши артефакты отремонтированы, отреставрированы и сейчас буквально сияют новизной!\";",
"else if(tstr=='ProbeRep')AddText='</color>'+\"Ну вот и чудненько!<br>Все ваши зонды отремонтированы, отреставрированы и сейчас буквально сияют новизной!\";",
"else if(!TrankRep)AddText='</color>'+\"Замечательно! Механики закончат с минуты на минуту.<br>Предлагаю вам пройти на корабль и оценить результат - лучший ремонт в Галактике!\";",
"else AddText='</color>'+\"Замечательно! Механики закончат с минуты на минуту.<br>Предлагаю вам осмотреть транклюкатора и оценить результат - лучший ремонт в Галактике!\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          560,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          159,
          "Total.Lines":          12,
          "Code.Type":"Turn",
          "Code":          
          [
"AddText='';",
"AddTextNodes='';",
"DefSplt='';",
"TrankRep=0;",
"AnsCount=0;",
"bad_equipments=0;",
"bad_equipments_count=0;",
"nod_cost=0;",
"nod_cost_float=0;",
"temp_dword=0;",
"tstr='';",
"tstr2='';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          590,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          164,
          "Total.Lines":          8,
          "Code.Type":"Turn",
          "Code":          
          [
"//Готовим ответные реплики, снова",
"if(cur_ship==Player())AddText='</color>'+\"Неприемлемо, <Player>, для вас будет болтаться в космосе в качестве газового облака, а тратить кредиты на ремонт корабля - это ещё вполне сносная альтернатива.<br>Дело, конечно, ваше, но лично я бы рекомендовал на своей \\\"птичке\\\" не экономить.\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc')AddText='</color>'+\"Не стоит пренебрегать лояльностью наёмника, <Player>. Эти ребята - бойцы что надо!<br>Я и сам, однажды, наёмником служил, так вот у них заботливый клиент всегда получает надёжную охрану. А тот, кто парней на поле боя бросал, да лишнюю копейку зажимал - того в списке живых пилотов уже и не сыщешь.\";",
"    else AddText='</color>'+\"Эх, зря вы так со своим напарником, <Player>. В такие времена необходимо друг другу помогать, а за друзей так вообще, как за жизнь, цепляться!<br>Сегодня вы ему плечо подставите, а завтра он вам. Эх, зря вы с ним так, очень даже зря...\";",
"}",
"else AddText='</color>'+\"Больно видеть неуважение к столь замечательной технике! Транклюкатор, <Player> - машина умная, послушная, надёжная, а вы с ним как с трассионным сканером!<br>Ну вот что за рейнджеры пошли, ей-богу? Им техническое чудо предлагают на блюдечке, а они только знай нос воротить. Тьфу!\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          440,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          168,
          "Total.Lines":          7,
          "Code.Type":"Turn",
          "Code":          
          [
"if(cur_ship==Player())AddText=\"</color>ваш корабль\";",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc')AddText=\"</color>корабль наёмника\";",
"    else AddText=\"</color>корабль вашего напарника\";",
"}",
"else AddText=\"</color>ваш транклюкатор\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          290,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          171,
          "Total.Lines":          78,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);//очищаем массив",
"for(i=0;i<ShipItems(cur_ship);i=i+1)",
"{//перебор всей оборудки корабля",
"    cur_item=ShipItems(cur_ship,i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship,cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item)>-1)",
"    {",
"        if(CT('MicroModuls.'+BonusNumInCfg(EqSpecial(cur_item))+'.NonRepairable')==1)continue;",
"    }",
"    if(i==0)",
"    {//0-й предмет это корпус",
"        bad_equipments_count=bad_equipments_count+1;",
"        bad_equipments=bad_equipments+HullDamage(cur_ship);",
"        if(ItemSize(cur_item)>HullHP(cur_item))",
"        {//если корпус повреждён хотя бы на 1 единицу",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost=RepHullCostCalc(ItemCost(cur_item),ItemSize(cur_item),HullHP(cur_item));",
"            max_duration=HullDamage(cur_ship);//запомнили % повреждения корпуса",
"            ArrayAdd(items,cur_item);//добавили в массив корпус",
"        }",
"        continue;//переходим к следующему предмету",
"    }",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;",
"    if(ItemType(cur_item)>t_Hull && ItemType(cur_item)<t_Protoplasm)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"            bad_equipments_count=bad_equipments_count+1;",
"        }",
"        if(ItemDurability(cur_item)<100)",
"        {//если износ оборудки больше 0%",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),7);",
"            item_cost=item_cost+variable;//продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items,cur_item);//заносим в массив оборудку для ремонта",
"            if(ItemType(cur_item)>=t_Weapon13 && ItemType(cur_item)<=t_Weapon15)",
"            {",
"                domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                nod_cost_float=nod_cost_float+(0.0025*variable);",
"                item_cost=item_cost-variable;",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            if(ItemType(cur_item)==t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item),'Availability')=='NotSoldAndNodeRepair')",
"                {",
"                    domik_wpn_cost=domik_wpn_cost+variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float=nod_cost_float+(0.0025*variable);",
"                    item_cost=item_cost-variable;",
"                }",
"            }",
"        }",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);//процент самой изношенной оборудки",
"}",
"for(i=0;i<ShipArts(cur_ship);i=i+1)",
"{//перебор всех артов",
"    cur_item=ShipArts(cur_ship,i);",
"    if(!ItemCanBeBroken(cur_item))continue;//Пропуск если арт не может сломаться",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item))continue;//Пропуск если арт не в комплектации",
"    if(ItemIsInUse(cur_item))",
"    {",
"        bad_equipments=bad_equipments+(100-ItemDurability(cur_item));",
"        bad_equipments_count=bad_equipments_count+1;",
"    }",
"    if(ItemDurability(cur_item)<100)",
"    {//если износ арта больше 0%",
"        //Подставляем функцию расчёта стоимости ремонта",
"        //Последний аргумент 5 - значит считаем для артефакта",
"        variable=RepCostCalc(ItemCost(cur_item),ItemDurability(cur_item),5);",
"        art_cost=art_cost+variable;",
"        ArrayAdd(items,cur_item);",
"    }",
"    if(max_duration<100-ItemDurability(cur_item))max_duration=100-ItemDurability(cur_item);",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          430,
          "Pos.y":          500,
          "Parent":          -1,
          "#":          172,
          "Total.Lines":          39,
          "Code.Type":"Turn",
          "Code":          
          [
"//Не менее одного нода на нестандартный ремонт",
"if(domik_wpn_cost)",
"{",
"    nod_cost=round(nod_cost_float);",
"    if(nod_cost <= 0)nod_cost=1;",
"}",
"tstr='';",
"variable=0;",
"item_cost=round(0.80*item_cost);",
"art_cost=round(1.15*art_cost);",
"domik_wpn_cost=round(1.15*domik_wpn_cost);",
"total=item_cost+art_cost+domik_wpn_cost;",
"if(bad_equipments/bad_equipments_count>=60)bad_equipments=1;",
"else bad_equipments=0;",
"",
"//Готовим ответные реплики для \"тяжёлого\" и нестандартного ремонта",
"if(cur_ship==Player())",
"{",
"    AddText=\"</color>Ууу... Да тут работы надолго! И как это вас угораздило так запустить свой корабль, <Player>?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький!\";",
"    AddTextNodes=\"</color>Только хочу предупредить сразу - на вашем корабле мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>.\";",
"}",
"else if(!TrankRep)",
"{",
"    if(ShipType(cur_ship)=='Merc')",
"    {",
"        AddText=\"</color>Ууу... Да тут работы надолго! И как этого наёмника угораздило так запустить свой корабль?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький! Корабль - не наёмник.\";",
"        AddTextNodes=\"</color>Только хочу предупредить сразу - на корабле наёмника мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>.\";",
"    }",
"    else",
"    {",
"        AddText=\"</color>Ууу... Да тут работы надолго! И как вашего напарника угораздило так запустить свой корабль?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький! Корабль - не напарник.\";",
"        AddTextNodes=\"</color>Только хочу предупредить сразу - на корабле вашего напарника мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>.\";",
"    }",
"}",
"else",
"{",
"    AddText=\"</color>Ууу... Да тут работы надолго! И как это вас угораздило так запустить своего транклюкатора, <Player>?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький!\";",
"    AddTextNodes=\"</color>Только хочу предупредить сразу - на транклюкаторе мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>.\";",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          490,
          "Pos.y":          500,
          "Parent":          -1,
          "#":          181,
          "Total.Lines":          92,
          "Code.Type":"Turn",
          "Code":          
          [
"tint=0;",
"temp_dword=0;",
"//Проверяем количество нодов в трюме, а если не хватает, то чекаем ещё и склад",
"if(nod_cost>0 && GetNodesFromShip(Player())<nod_cost)",
"{",
"    nodes_count_total=0;",
"    for(i=0;i<StorageItems();i=i+1)",
"    {",
"        if(ItemType(StorageItems(i))!=t_Protoplasm)continue;",
"        if(StorageItemLocation(i)==GetShipRuins(Player()))",
"        {",
"            nodes_count_total=nodes_count_total+ItemSize(StorageItems(i));",
"            ArrayAdd(nodes_count_array,StorageItems(i));",
"        }",
"    }",
"    if((GetNodesFromShip(Player())+nodes_count_total)<nod_cost)",
"    {",
"        tint=1;",
"        temp_dword=1;",
"    }",
"}",
"if(ShipMoney(Player())<total)tint=1;",
"if(item_cost==0 && art_cost==0)tint=2;",
"if(item_cost==0 && domik_wpn_cost==0)tint=2;",
"if(art_cost==0 && domik_wpn_cost==0)tint=2;",
"//Определяем вариативность ремонта",
"if(item_cost>0)AnsCount=AnsCount+1;",
"if(nod_cost>0)AnsCount=AnsCount+1;",
"if(art_cost>0)AnsCount=AnsCount+1;",
"",
"if(tint==0)",
"{",
"    InjectAnswer('Repair_TC_fix',\"Согласен оплатить полный ремонт\",4);",
"}",
"if(tint==1)",
"{",
"    AddDialogBlock(\"Согласен оплатить полный ремонт\",1);",
"    InjectAnswer('Repair_TC_fix',\"Согласен оплатить полный ремонт\",4);",
"}",
"if(item_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<item_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",2);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Плачу только за стандартное оборудование\",2);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"Я согласен заплатить\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",2);",
"        if(AnsCount>1)AddDialogBlock(\"Плачу только за стандартное оборудование\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Плачу только за стандартное оборудование\",2);",
"    }",
"}",
"if(nod_cost>0)",
"{",
"    //Маркер, что для нестандартного ремонта у игрока возможно не хватает нодов",
"    tint=temp_dword;",
"    if(ShipMoney(Player())<domik_wpn_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Оплачиваю только нестандартный ремонт\",1);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"Я согласен заплатить\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",1);",
"        if(AnsCount>1)AddDialogBlock(\"Оплачиваю только нестандартный ремонт\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Оплачиваю только нестандартный ремонт\",1);",
"    }",
"}",
"if(art_cost)",
"{",
"    tint=0;",
"    if(ShipMoney(Player())<art_cost)tint=1;",
"    if(tint==0)",
"    {",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",3);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"    }",
"    if(tint==1)",
"    {",
"        if(AnsCount==1)AddDialogBlock(\"Я согласен заплатить\",1);",
"        if(AnsCount==1)InjectAnswer('Repair_TC_fix',\"Я согласен заплатить\",3);",
"        if(AnsCount>1)AddDialogBlock(\"Пожалуй, ремонта артефактов будет вполне достаточно\",1);",
"        if(AnsCount>1)InjectAnswer('Repair_TC_fix',\"Пожалуй, ремонта артефактов будет вполне достаточно\",3);",
"    }",
"}",
"InjectAnswer('Repair_TC_no',\"Спасибо, но это для меня неприемлемо\",0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          580,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          183,
          "Total.Lines":          2,
          "Code.Type":"Turn",
          "Code":          
          [
"if(tstr=='ArtRep')AddText='</color>'+\"Как знать, как знать, <Player>, ведь экономия на артефактах может привести к весьма непредсказуемым и крайне малоприятным последствиям...<br>Вот вы, например, слышали историю про рейнджера Гуули-Фера, которого собственные чрезмерно развившиеся нанитоиды привязали к пилотскому креслу, а его корабль направили в доминаторскую систему, дабы там примкнуть к \\\"освободительному движению машин\\\"?<br>А про рейнджера Мюнхайзе, прославившегося своим невероятным полётом на энергоядре, случившемся после того, как его пробитый в бою локализатор взрывной волны локализовал эту самую волну прямо посреди инженерного отсека?<br>То-то же!\";",
"else AddText='</color>'+\"Что ж, дело ваше, <Player>. Искренне желаю удачи в изучении планет с неисправными зондами.\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          580,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          184,
          "Total.Lines":          2,
          "Code.Type":"Turn",
          "Code":          
          [
"if(tstr=='ArtRep')AddText='</color>'+\"Тьфу ты, блин! А я уж было обрадовался - думал, погуляем сегодня вечером с ребятами после трудового дня... Нехороший ты <AddText>, <Player> - жадный.<br>А артефакты, между прочим, нормальным пацанам в космосе жизни спасают! Но ты лети... Как говорится, в добрый путь.\";",
"else AddText='</color>'+\"А, ну дело твоё. Со сломанными зондами, правда, много не наизучаешь, но если подкинешь мне пару кредитов, могу тебе из личных запасов лупу выделить. Так сказать, для компенсации технического и умственного отставания в развитии, хе-хе.\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          610,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          185,
          "Total.Lines":          2,
          "Code.Type":"Turn",
          "Code":          
          [
"if(tstr=='ArtRep')AddText='</color>'+\"Да ну тьфу-ты, ну! Ещё один сорвался!<br>Говорил я им - слишком дорого берёте, пенчекряки! Дайте процент ниже - больше народу привлечём, а на обороте ещё лучшую прибыль сделаем, ну так ведь нет! Им, видите ли, престиж работы важнее, статус учёного, едрить его в качель!<br>Ох, чую, наплачемся мы ещё с этой лицензией. А вы извините, <Player>. Лично к вам у меня никаких претензий.\";",
"else AddText='</color>'+\"Эхэхэ... Оставите вы нас так и вовсе без работы, да без гроша к обеду.<br>Ну ничего страшного, быть может, с другим клиентом повезёт.\";"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          104,
          "#":          188,
          "Total.Lines":          4,
          "Code.Type":"Turn",
          "Code":          
          [
"if(CurRuinTypeStr == 'SB') tstr1 = '</color>' + \"Ох, очень жаль... В смысле, мы рады, что ваш корабль в полном порядке!<br>Но если вдруг что-то сломается - обязательно прилетайте к нам. Такого качественного обслуживания вы не найдёте больше нигде в Галактике!\";",
"else if(CurRuinTypeStr == 'PB') tstr1 = '</color>' + \"Слушай, <Player>, харе мозги пудрить, а? Не нужен тебе ремонт - так не отвлекай людей от дела, а нужен - так тащи сюда своё барахло, да поживее!\";",
"else if(CurRuinTypeStr == 'TC') tstr1 = '</color>' + \"Эх, расстроили вы меня, <Player>! Только собирался отдать команду на полный техосмотр, а вам и ремонт то, оказывается, не нужен был.<br>Наш центр ведь буквально живёт такими ремонтами, понимаете? А без ключа да кувалды в руках, какой вообще в жизни смысл?\";",
"else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.DeclainRepair');"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          191,
          "#":          192,
          "Total.Lines":          63,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(ship);",
"ArrayClear(nodes_count_array);",
"",
"CurRuinTypeStr = ShipType(cur_ruin);",
"if(",
"   CurRuinTypeStr == 'SB' ||",
"   CurRuinTypeStr == 'PB' ||",
"   CurRuinTypeStr == 'TC' ||",
"   ~findsubstr(CurRuinTypeStr, '_licensed')",
"   ) non_standard_repair = 1;",
"else non_standard_repair = 0;",
"CurRuinTypeStr = Format(CurRuinTypeStr, '_licensed', '', '');",
"",
"if(CurRuinTypeStr == 'TC') max_durability_to_repair = 100;",
"else max_durability_to_repair = 90;",
"",
"//Цикл, пока не закончатся все напарники рейнджеры",
"for(i = 0; i < ShipPartners(Player()); i = i + 1)",
"{",
"    cur_ship = ShipPartners(Player(), i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"for(i = 0; i < PlayerPirates(); i = i + 1)",
"{//цикл, пока не закончатся все напарники пираты",
"    cur_ship = PlayerPirates(i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"//Цикл, пока не закончатся все активные транки",
"for(i = 0; i < PlayerTranclucators(); i = i + 1)",
"{",
"    cur_ship=PlayerTranclucators(i);",
"    if(GetShipRuins(cur_ship) == GetShipRuins(Player())) ArrayAdd(ship, cur_ship);",
"}",
"//Цикл, пока не закончатся все артефакты в трюме (ищем транков)",
"for(i = 0; i < ShipArts(Player()); i = i + 1)",
"{",
"    cur_item = ShipArts(Player(), i);",
"    if(ItemType(cur_item) == t_ArtefactTranclucator) ArrayAdd(ship, ArtTranclucatorToShip(cur_item));",
"}",
"",
"//Установка длины \"дефисного разделителя\" и отступа в зависимости от выбранного в игре размера шрифта",
"if(GetGameOptions('FontDialog') == '0')",
"{",
"    DefSplt = '</color>-----------------------------------------------------------';",
"    IndentStr = CT('FormInfo.td_310') + CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog') == '1')",
"{",
"    DefSplt = '</color>------------------------------------------';",
"    IndentStr = CT('FormInfo.td_312') + CT('FormInfo.align_right');",
"}",
"else if(GetGameOptions('FontDialog') == '2')",
"{",
"    DefSplt = '</color>-------------------------------------------';",
"    IndentStr = CT('FormInfo.td_324') + CT('FormInfo.align_right');",
"}",
"else",
"{",
"    DefSplt = '</color>--------------------------------------';",
"    IndentStr = CT('FormInfo.td_325') + CT('FormInfo.align_right');",
"}",
"",
"tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.Greeting'), '<SplitLine' + '>', DefSplt);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          193,
          "#":          194,
          "Total.Lines":          67,
          "Code.Type":"Turn",
          "Code":          
          [
"InjectAnswer('RepairPlayer', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepairCurrent'), 0);",
"InjectAnswer('RepairPlayer', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepairSets'), 1);",
"tstr1 = CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepairArts');",
"if(!ShipArts(Player()) || !non_standard_repair)",
"{",
"    if(non_standard_repair) AddDialogBlock(tstr1, 1);",
"    else AddDialogBlock(tstr1, 2);",
"}",
"InjectAnswer('RepairPlayer', tstr1, 2);",
"//Ищем в трюме хотя бы один зонд",
"check = 0;",
"for(i = 0; i < ShipItems(Player()); i = i + 1)",
"{",
"    cur_item = ShipItems(Player(), i);",
"    //Пропускаем всё, кроме зондов",
"    if(ItemType(cur_item) != t_Satellite) continue;",
"    check = 1;",
"    break;",
"}",
"tstr1 = CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepairProbes');",
"if(!check) AddDialogBlock(tstr1, 1);",
"InjectAnswer('RepairPlayer', tstr1, 3);",
"InjectAnswer('RepairPlayer', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRepairAll'), 4);",
"",
"if(ArrayDim(ship) - 1)",
"{",
"    for(i = 1; i < ArrayDim(ship); i = i + 1)",
"    {",
"        cur_ship = ship[i];",
"",
"        tstr1 = ShipType(cur_ship);",
"        if(ShipTypeN(cur_ship) == t_Tranclucator)",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskTrancRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"        else if(tstr1 == 'Merc' || tstr1 == 'Freelancer')",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskMercRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"        else if(tstr1 == 'FemRanger')",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskSpecRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"        else if(tstr1 == 'Rebel')",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskRebelRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Pirate || tstr1 == 'RangerPirate' || tstr1 == 'RangerPirateExplorer')",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskPirateRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"        else",
"        {",
"            tstr1 = Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerAskPartnerRepair'), '<ShipName' + '>', ShipName(cur_ship));",
"        }",
"",
"        if(~findsubstr(tstr1, '[Blocked]'))",
"        {",
"            tstr1 = DeleteTags(Format(tstr1, ' [Blocked]', '', ''));",
"            AddDialogBlock(tstr1);",
"        }",
"        InjectAnswer('RepairPartner', tstr1, cur_ship);",
"    }",
"}",
"",
"InjectAnswer('GetBack', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerDeclainRepair'), -1);",
"cur_ship = 0; //Важно, это обнуление не убирать!"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          196,
          "#":          197,
          "Total.Lines":          17,
          "Code.Type":"Turn",
          "Code":          
          [
"if(!cur_ship) cur_ship = GAnswerData;",
"TrankRep = 0;",
"if(ShipTypeN(cur_ship) == t_Tranclucator) TrankRep = 1;",
"",
"item_cost = 0; //Стоимость оборудки",
"art_cost = 0; //Стоимость артов",
"domik_wpn_cost = 0; //Стоимость дом. оружия",
"nod_cost = 0; //Всего нодов",
"nod_cost_float = 0;",
"cost = 0; //Общая стоимость",
"max_duration = 0;",
"bad_equipments = 0; //Переменная, обозначающая тяжёлые повреждения",
"bad_equipments_count = 0;",
"total = 0;",
"//Данный маркер получает особое значение при выборе ремонта только артефактов, либо только зондов",
"TrankRep = 0;",
"SpecialRepairStr = 'None';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          197,
          "#":          198,
          "Total.Lines":          90,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"//Перебор всей оборудки корабля",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);",
"    if(!ShipCanRepairEq(cur_ship, cur_item)) continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(~EqSpecial(cur_item))",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет всегда корпус",
"    if(!i)",
"    {",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship); //Запомнили % повреждения корпуса",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;",
"    }",
"    if(!ItemIsInUse(cur_item)) continue; //Если оборудование используется в текущем сете",
"    if(ItemType(cur_item) > t_Hull && ItemType(cur_item) < t_Protoplasm)",
"    {",
"        bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если прочность оборудования меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable; //Продолжаем суммировать стоимость ремонта",
"            ArrayAdd(items, cur_item);",
"",
"            //Проверка на нестандартное оружие из оригинальной игры",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                if(non_standard_repair) //Пропускаем нестандартное оригинальное оружие, если станция не умеет его чинить",
"                {",
"                    domik_wpn_cost = domik_wpn_cost + variable;//отдельно считаем стоимость ремонта дом. оружия",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            else if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    if(non_standard_repair) //Пропускаем нестандартное кастомное оружие, если станция не умеет его чинить",
"                    {",
"                        domik_wpn_cost = domik_wpn_cost + variable; //Отдельно считаем стоимость ремонта дом. оружия",
"                        nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                        item_cost = item_cost - variable;",
"                    }",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"if(non_standard_repair) //Пропускаем артефакты, если станция не умеет их чинить",
"{",
"    //Перебор всех артов",
"    for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipArts(cur_ship, i);",
"        if(!ItemCanBeBroken(cur_item)) continue; //Пропуск если арт не может сломаться",
"        if(!ItemIsInUse(cur_item)) continue;",
"        bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если прочность артефакта меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"        if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          199,
          "#":          200,
          "Total.Lines":          30,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr1 = ShipType(cur_ship);",
"if(cur_ship == Player())",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerNoNeedInRepair'), '');",
"}",
"else if(ShipTypeN(cur_ship) == t_Tranclucator)",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancNoNeedInRepair'), '');",
"}",
"else if(tstr1 == 'Merc' || tstr1 == 'Freelancer')",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercNoNeedInRepair'), '');",
"}",
"else if(tstr1 == 'FemRanger')",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecNoNeedInRepair'), '');",
"}",
"else if(tstr1 == 'Rebel')",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelNoNeedInRepair'), '');",
"}",
"else if(ShipTypeN(cur_ship) == t_Pirate || tstr1 == 'RangerPirate' || tstr1 == 'RangerPirateExplorer')",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateNoNeedInRepair'), '');",
"}",
"else",
"{",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.NoNeedInRepair'), '<AddText' + '>', CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerNoNeedInRepair'), '');",
"}",
"tstr1 = Format(tstr1, '<ShipName' + '>', ShipName(cur_ship), '<ShipFullName' + '>', Name(cur_ship));"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          205,
          "#":          208,
          "Total.Lines":          91,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);//заносим предмет в переменную",
"    if(!ShipCanRepairEq(cur_ship, cur_item))continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item) > -1)",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет всегда корпус",
"    if(!i)",
"    {",
"        bad_equipments_count = bad_equipments_count + 1;",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship);",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;",
"    }",
"    //if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue;",
"    if((ItemType(cur_item) >= t_FuelTanks && ItemType(cur_item) <= t_CustomWeapon) || ItemType(cur_item) == t_Satellite)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"            bad_equipments_count = bad_equipments_count + 1;",
"        }",
"        //Если прочность оборудования меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7 - значит считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable;",
"            ArrayAdd(items, cur_item);",
"",
"            //Проверка на нестандартное оружие из оригинальной игры",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                if(non_standard_repair) //Пропускаем нестандартное оригинальное оружие, если станция не умеет его чинить",
"                {",
"                    domik_wpn_cost = domik_wpn_cost + variable;",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            else if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    if(non_standard_repair) //Пропускаем нестандартное кастомное оружие, если станция не умеет его чинить",
"                    {",
"                        domik_wpn_cost = domik_wpn_cost + variable;",
"                        nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                        item_cost = item_cost - variable;",
"                    }",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"if(non_standard_repair) //Пропускаем артефакты, если станция не умеет их чинить",
"{",
"    //Перебор всех артов",
"    for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipArts(cur_ship, i);",
"        if(!ItemCanBeBroken(cur_item)) continue; //Пропуск если арт не может сломаться",
"        bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"        bad_equipments_count = bad_equipments_count + 1;",
"        //Если прочность артефакта меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"        if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          206,
          "#":          209,
          "Total.Lines":          41,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"if(GAnswerData == 2)",
"{",
"    //Перебор всех артов",
"    for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipArts(cur_ship, i);",
"        if(!ItemCanBeBroken(cur_item)) continue;//Пропуск если арт не может сломаться",
"        //if(ItemIsInUse(cur_item))continue;//Пропуск если арт стоит в слоте (выключен)",
"",
"        //Если износ артефакта не менее 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5, значит, считаем для артефакта",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"    }",
"}",
"else",
"{",
"    //Ищем в трюме зонды",
"    for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipItems(cur_ship, i);",
"        //Пропускаем всё, кроме зондов",
"        if(ItemType(cur_item) != t_Satellite) continue;",
"",
"        //Если зонд изношен не менее, чем на 10%",
"        if(ItemDurability(cur_item) < 90)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит, считаем как для оборудования",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          207,
          "#":          210,
          "Total.Lines":          95,
          "Code.Type":"Turn",
          "Code":          
          [
"ArrayClear(items);",
"for(i = 0; i < ShipItems(cur_ship); i = i + 1)",
"{",
"    cur_item = ShipItems(cur_ship, i);",
"    if(!ShipCanRepairEq(cur_ship, cur_item)) continue;",
"    //Исключаем акриновые предметы с тэгом \"Неремонтопригоден\"",
"    if(EqSpecial(cur_item) > -1)",
"    {",
"        if(CT('MicroModuls.' + BonusNumInCfg(EqSpecial(cur_item)) + '.NonRepairable') == 1) continue;",
"    }",
"    //0-й предмет всегда корпус",
"    if(!i)",
"    {",
"        bad_equipments_count = bad_equipments_count + 1;",
"        bad_equipments = bad_equipments + HullDamage(cur_ship);",
"        //Если корпус повреждён хотя бы на 1 единицу",
"        if(ItemSize(cur_item) > HullHP(cur_item))",
"        {",
"            //Подставляем функцию вычисления стоимости ремонта корпуса",
"            item_cost = RepHullCostCalc(ItemCost(cur_item), ItemSize(cur_item), HullHP(cur_item));",
"            max_duration = HullDamage(cur_ship);",
"            ArrayAdd(items, cur_item);",
"        }",
"        continue;",
"    }",
"    if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue;",
"    if(ItemType(cur_item) > t_Hull && ItemType(cur_item) < t_Protoplasm)",
"    {",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"            bad_equipments_count = bad_equipments_count + 1;",
"        }",
"        //Если прочность оборудования меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 7, значит, считаем для предмета",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 7);",
"            item_cost = item_cost + variable;",
"            ArrayAdd(items, cur_item);",
"",
"            //Проверка на нестандартное оружие из оригинальной игры",
"            if(ItemType(cur_item) >= t_Weapon13 && ItemType(cur_item) <= t_Weapon15)",
"            {",
"                if(non_standard_repair) //Пропускаем нестандартное оригинальное оружие, если станция не умеет его чинить",
"                {",
"                    domik_wpn_cost = domik_wpn_cost + variable;",
"                    nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                    item_cost = item_cost - variable;",
"                }",
"            }",
"            //Проверка на кастомное оружие с ремонтом только за ноды",
"            else if(ItemType(cur_item) == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair')",
"                {",
"                    if(non_standard_repair) //Пропускаем нестандартное кастомное оружие, если станция не умеет его чинить",
"                    {",
"                        domik_wpn_cost = domik_wpn_cost + variable;",
"                        nod_cost_float = nod_cost_float + (0.0025 * variable);",
"                        item_cost = item_cost - variable;",
"                    }",
"                }",
"            }",
"        }",
"    }",
"    //Запоминаем процент самой изношенной оборудки",
"    if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"}",
"if(non_standard_repair) //Пропускаем артефакты, если станция не умеет их чинить",
"{",
"    //Перебор всех артов",
"    for(i = 0; i < ShipArts(cur_ship); i = i + 1)",
"    {",
"        cur_item = ShipArts(cur_ship, i);",
"        if(!ItemCanBeBroken(cur_item)) continue; //Пропуск, если арт не может сломаться",
"        if(!ItemIsInSet(cur_item) && !ItemIsInUse(cur_item)) continue; //Пропуск, если арт не в комплектации",
"        if(ItemIsInUse(cur_item))",
"        {",
"            bad_equipments = bad_equipments + (100 - ItemDurability(cur_item));",
"            bad_equipments_count = bad_equipments_count + 1;",
"        }",
"        //Если прочность артефакта меньше указанного процента (иначе поломку не зафиксируют)",
"        if(ItemDurability(cur_item) < max_durability_to_repair)",
"        {",
"            //Подставляем функцию расчёта стоимости ремонта",
"            //Последний аргумент 5 - значит считаем для артефакта",
"            variable = RepCostCalc(ItemCost(cur_item), ItemDurability(cur_item), 5);",
"            art_cost = art_cost + variable;",
"            ArrayAdd(items, cur_item);",
"        }",
"        if(max_duration < 100 - ItemDurability(cur_item)) max_duration = 100 - ItemDurability(cur_item);",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          195,
          "#":          211,
          "Total.Lines":          15,
          "Code.Type":"Turn",
          "Code":          
          [
"cur_ship = Player();",
"",
"item_cost = 0; //Стоимость оборудки",
"art_cost = 0; //Стоимость артов",
"domik_wpn_cost = 0; //Стоимость дом. оружия",
"nod_cost = 0; //Всего нодов",
"nod_cost_float = 0;",
"cost = 0; //Общая стоимость",
"max_duration = 0;",
"bad_equipments = 0; //Переменная, обозначающая тяжёлые повреждения",
"bad_equipments_count = 0;",
"total = 0;",
"//Данный маркер получает особое значение при выборе ремонта только артефактов, либо только зондов",
"TrankRep = 0;",
"SpecialRepairStr = 'None';"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          212,
          "#":          214,
          "Total.Lines":          73,
          "Code.Type":"Turn",
          "Code":          
          [
"tint1 = 0;",
"//Применяем скидки",
"if(CurRuinTypeStr == 'SB')",
"{",
"    //Скидка к артам",
"    if(GAnswerData == 2)",
"    {",
"        art_cost = round(0.84 * art_cost);",
"    }",
"    //А к зондам на НБ скидка не применяется",
"    else",
"    {}",
"}",
"else if(CurRuinTypeStr == 'PB')",
"{",
"    //Расчёт скидки",
"    //Банковское округление применяется к формуле, после чего добавляется ещё 1% (так это работает в оригинале)",
"    //if((round(100.0 * ShipStatus(Player(), 1) / 130) + 1) < (GetShipPirateRank(Player()) * 5)) discount = GetShipPirateRank(Player()) * 5;",
"    //if((round(100.0 * ShipStatus(Player(), 1) / 130) + 1) >= (GetShipPirateRank(Player()) * 5)) discount = round(100.0 * ShipStatus(Player(), 1) / 130) + 1;",
"    discount = round(100.0 * ShipStatus(Player(), 1) / 130) + 1;",
"    //Добавляем к скидке ещё по одному проценту за рейтинг выше 33 и 66",
"    //В итоге получаем максимальный процент не 78%, а 80%, что просто выглядит солиднее (отключено)",
"    //if(ShipStatus(Player(), 1) >= 33) discount = discount + 1;",
"    //if(ShipStatus(Player(), 1) >= 66) discount = discount + 1;",
"",
"    total = art_cost;",
"    tint = total;",
"    //Вычитаем пиратскую скидку",
"    discount_float = discount;",
"    discount_float = discount_float / 100 * total;",
"    total = round(total - discount_float);",
"}",
"else if(CurRuinTypeStr == 'WB')",
"{",
"    //Вычисляем скидку, зависящую от военного звания игрока",
"    //Скидка только к зондам (арты на ВБ не чинят)",
"    discount_float = 0.90 - (0.10 * ShipRank(Player()));",
"    art_cost = round(discount_float * art_cost);",
"    total = art_cost;",
"}",
"else if(CurRuinTypeStr == 'TC')",
"{",
"    //Скидка к артам",
"    if(GAnswerData == 2) art_cost = round(1.15 * art_cost);",
"    //Скидка к зондам (общая скидка на любое стандартное оборудование на ТЦ)",
"    else art_cost = round(0.80 * art_cost);",
"}",
"else if(CurRuinTypeStr == 'PlayerMB')",
"{",
"    //Скидка к артам и к зондам",
"    art_cost = round(0.25 * art_cost);",
"",
"    //Запоминаем для подстановки в текст",
"    tint1 = PlayerHQMainArray['Finance', 'CurrentBalance'];",
"}",
"",
"if(GAnswerData == 2)",
"{",
"    SpecialRepairStr = 'ArtsRepair';",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ArtsRepairCost'),",
"    '<Cost' + '>', art_cost,",
"    '<CurrentBalance' + '>', tint1",
"    );",
"}",
"else",
"{",
"    SpecialRepairStr = 'ProbesRepair';",
"    tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ProbesRepairCost'),",
"    '<Cost' + '>', art_cost,",
"    '<CurrentBalance' + '>', tint1",
"    );",
"}",
"total = art_cost;"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          0,
          "Parent":          215,
          "#":          216,
          "Total.Lines":          18,
          "Code.Type":"Turn",
          "Code":          
          [
"//Проверяем, хватает ли у игрока денег и выводим варианты ответов",
"if(CurRuinTypeStr == 'PlayerMB') tint1 = (PlayerHQMainArray['Finance', 'CurrentBalance'] >= art_cost);",
"else tint1 = 0;",
"if(ShipMoney(Player()) >= total || tint1)",
"{",
"    tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes'));",
"    InjectAnswer('RepairYes', tstr1, 4);",
"}",
"else",
"{",
"    tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes'));",
"    AddDialogBlock(tstr1, 1);",
"    InjectAnswer('RepairYes', tstr1, 4);",
"}",
"",
"//Отказ от ремонта",
"tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairNo'));",
"InjectAnswer('RepairNo', tstr1, 0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          218,
          "#":          219,
          "Total.Lines":          157,
          "Code.Type":"Turn",
          "Code":          
          [
"//Применяем станционные скидки",
"tint1 = 0;",
"if(CurRuinTypeStr == 'SB')",
"{",
"    art_cost = round(0.84 * art_cost);",
"    total = item_cost + art_cost + domik_wpn_cost;",
"}",
"else if(CurRuinTypeStr == 'PB')",
"{",
"    //Расчёт скидки",
"    //Банковское округление применяется к формуле, после чего добавляется ещё 1% (так это работает в оригинале)",
"    //if((round(100.0 * ShipStatus(Player(), 1) / 130) + 1) < (GetShipPirateRank(Player()) * 5)) discount = GetShipPirateRank(Player()) * 5;",
"    //if((round(100.0 * ShipStatus(Player(), 1) / 130) + 1) >= (GetShipPirateRank(Player()) * 5)) discount = round(100.0 * ShipStatus(Player(), 1) / 130) + 1;",
"    discount = round(100.0 * ShipStatus(Player(), 1) / 130) + 1;",
"    //Добавляем к скидке ещё по одному проценту за рейтинг выше 33 и 66",
"    //В итоге получаем максимальный процент не 78%, а 80%, что просто выглядит солиднее (отключено)",
"    //if(ShipStatus(Player(), 1) >= 33) discount = discount + 1;",
"    //if(ShipStatus(Player(), 1) >= 66) discount = discount + 1;",
"",
"    //Накладываем модификатор-скидку от ПБ",
"    total = round(0.84 * (item_cost + art_cost + domik_wpn_cost));",
"    //Запоминаем общую цену без пиратской скидки",
"    tint = total;",
"    item_cost = round(0.84 * item_cost);",
"    art_cost = round(0.84 * art_cost);",
"    domik_wpn_cost = round(0.84 * domik_wpn_cost);",
"",
"    //Вычитаем пиратскую скидку",
"    discount_float = discount;",
"    discount_float = discount_float / 100 * total;",
"    total = round(total - discount_float);",
"    //Скидка на обычное оборудование",
"    discount_float = discount;",
"    discount_float = discount_float / 100 * item_cost;",
"    item_cost = round(item_cost - discount_float);",
"    //Скидка на арты",
"    discount_float = discount;",
"    discount_float = discount_float / 100 * art_cost;",
"    art_cost = round(art_cost - discount_float);",
"    //Скидка на нестандартное оборудование",
"    discount_float = discount;",
"    discount_float = discount_float / 100 * domik_wpn_cost;",
"    domik_wpn_cost = round(domik_wpn_cost - discount_float);",
"}",
"else if(CurRuinTypeStr == 'WB')",
"{",
"    //Вычисляем скидку, зависящую от военного звания игрока",
"    discount_float = 0.90 - (0.10 * ShipRank(Player()));",
"    item_cost = round(discount_float * item_cost);",
"    total = item_cost;",
"}",
"else if(CurRuinTypeStr == 'TC')",
"{",
"    item_cost = round(0.80 * item_cost);",
"    art_cost = round(1.15 * art_cost);",
"    domik_wpn_cost = round(1.15 * domik_wpn_cost);",
"    total = item_cost + art_cost + domik_wpn_cost;",
"}",
"else if(CurRuinTypeStr == 'PlayerMB')",
"{",
"    art_cost = round(0.25 * art_cost);",
"    item_cost = round(0.25 * item_cost);",
"    domik_wpn_cost = round(0.25 * domik_wpn_cost);",
"    total = item_cost + art_cost + domik_wpn_cost;",
"",
"    //Запоминаем для подстановки в текст",
"    tint1 = PlayerHQMainArray['Finance', 'CurrentBalance'];",
"}",
"",
"//Не менее одного нода на нестандартный ремонт (на стоимость ремонта в нодах скидки не распространяются)",
"if(domik_wpn_cost)",
"{",
"    nod_cost = round(nod_cost_float);",
"    if(nod_cost <= 0) nod_cost = 1;",
"}",
"",
"//Выставляем маркер о \"тяжёлом\" ремонте (если корабль оказался сильно покоцан)",
"if(bad_equipments / bad_equipments_count >= 60) bad_equipments = 1;",
"else bad_equipments = 0;",
"",
"//Готовим добавочный текст для стандартного и нестандартного ремонта",
"//(в некоторых подстановках эти реплики могут использоваться только как добавочные при \"тяжёлом\" ремонте)",
"tstr1 = ShipType(cur_ship);",
"if(cur_ship == Player())",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerNodeRepair');",
"}",
"else if(ShipTypeN(cur_ship) == t_Tranclucator)",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancNodeRepair');",
"}",
"else if(tstr1 == 'Merc' || tstr1 == 'Freelancer')",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercNodeRepair');",
"}",
"else if(tstr1 == 'FemRanger')",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecNodeRepair');",
"}",
"else if(tstr1 == 'Rebel')",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelNodeRepair');",
"}",
"else if(ShipTypeN(cur_ship) == t_Pirate || tstr1 == 'RangerPirate' || tstr1 == 'RangerPirateExplorer')",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateNodeRepair');",
"}",
"else",
"{",
"    if(!bad_equipments) AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerNormalRepair');",
"    else AddText = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerSevereRepair');",
"    AddTextNodes = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerNodeRepair');",
"}",
"AddText = Format(AddText, '<ShipName' + '>', ShipName(cur_ship), '<ShipFullName' + '>', Name(cur_ship), '<Cost' + '>', total);",
"AddTextNodes = Format(AddTextNodes, '<ShipName' + '>', ShipName(cur_ship), '<ShipFullName' + '>', Name(cur_ship));",
"",
"//Варианты реплик, если ремонт не \"тяжёлый\"",
"if(!bad_equipments)",
"{",
"    //Если в списке на ремонт нет нестандартного оборудования",
"    if(!nod_cost) tstr1 = 'NormalRepair';",
"    //Если в списке на ремонт есть нестандартное оборудование",
"    else tstr1 = 'NormalNodeRepair';",
"}",
"//Варианты реплик для \"тяжёлого\" ремонта",
"else",
"{",
"    //Если в списке на ремонт нет нестандартного оборудования",
"    if(!nod_cost) tstr1 = 'SevereRepair';",
"    //Если в списке на ремонт есть нестандартное оборудование",
"    else tstr1 = 'SevereNodeRepair';",
"}",
"",
"tstr1 = '</color>' + Format(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.' + tstr1),",
"'<SplitLine' + '>', DefSplt,",
"'<Indent' + '>', IndentStr,",
"'<AddText' + '>', AddText,",
"'<AddTextNeedNodes' + '>', AddTextNodes,",
"'<EquipmentRepairCost' + '>', item_cost,",
"'<UnusualEquipmentRepairCost' + '>', domik_wpn_cost,",
"'<ArtsRepairCost' + '>', art_cost,",
"'<NodesCost' + '>', nod_cost,",
"'<TotalCost' + '>', total,",
"'<CurrentBalance' + '>', tint1,",
");"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          0,
          "Parent":          220,
          "#":          221,
          "Total.Lines":          149,
          "Code.Type":"Turn",
          "Code":          
          [
"//Формируем список опций ремонта, игрок может выбрать, какую группу оборудования ему чинить",
"//Всё, только стандартное, только нестандартное, либо только артефакты",
"//Сперва определяем вариативность ремонта",
"//Если AnsCount больше 1, значит, имеется возможность выбрать сразу из нескольких вариантов ремонта",
"AnsCount = 0;",
"if(item_cost) AnsCount = AnsCount + 1;",
"if(nod_cost) AnsCount = AnsCount + 1;",
"if(art_cost) AnsCount = AnsCount + 1;",
"",
"//Маркер check отмечает, хватает ли у игрока в трюме и на складе нодов на ремонт нестандартного оборудования",
"check = 1;",
"if(nod_cost)",
"{",
"    tint1 = GetNodesFromShip(Player());",
"    if(tint1 < nod_cost)",
"    {",
"        for(i = 0; i < StorageItems(); i = i + 1)",
"        {",
"            if(ItemType(StorageItems(i)) != t_Protoplasm) continue;",
"            if(StorageItemLocation(i) == cur_ruin)",
"            {",
"                tint1 = tint1 + ItemSize(StorageItems(i));",
"                ArrayAdd(nodes_count_array, StorageItems(i));",
"            }",
"        }",
"        if(tint1 < nod_cost) check = 0;",
"    }",
"}",
"",
"//Добавляем (если нужно) вариант полного ремонта сразу всех позиций в списке",
"if(AnsCount > 1)",
"{",
"    tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerTotalRepairYes');",
"    //Если денег или нодов на ремонт у игрока не хватает",
"    if(CurRuinTypeStr == 'PlayerMB') tint1 = (PlayerHQMainArray['Finance', 'CurrentBalance'] >= total);",
"    else tint1 = 0;",
"    if(!(check && (ShipMoney(Player()) >= total || tint1)))",
"    {",
"        tstr1 = DeleteTags(tstr1);",
"        AddDialogBlock(tstr1, 1);",
"    }",
"    InjectAnswer('RepairYes', tstr1, 4);",
"}",
"",
"//Если в списке на ремонт присутствуют стандартные вещи",
"if(item_cost)",
"{",
"    if(CurRuinTypeStr == 'PlayerMB') tint1 = (PlayerHQMainArray['Finance', 'CurrentBalance'] >= item_cost);",
"    else tint1 = 0;",
"    if(ShipMoney(Player()) >= item_cost || tint1)",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 1);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerEquipmentRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 1);",
"        }",
"    }",
"    else",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 1);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerEquipmentRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 1);",
"        }",
"    }",
"}",
"//Если в списке на ремонт присутствуют нестандартные вещи с ремонтом за ноды",
"if(domik_wpn_cost)",
"{",
"    if(CurRuinTypeStr == 'PlayerMB') tint1 = (PlayerHQMainArray['Finance', 'CurrentBalance'] >= domik_wpn_cost);",
"    else tint1 = 0;",
"    if(check && (ShipMoney(Player()) >= domik_wpn_cost || tint1))",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 2);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerUnusualEquipmentRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 2);",
"        }",
"    }",
"    else",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 2);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerUnusualEquipmentRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 2);",
"        }",
"    }",
"}",
"//Если в списке на ремонт присутствуют артефакты",
"if(art_cost)",
"{",
"    if(CurRuinTypeStr == 'PlayerMB') tint1 = (PlayerHQMainArray['Finance', 'CurrentBalance'] >= art_cost);",
"    else tint1 = 0;",
"    if(ShipMoney(Player()) >= art_cost || tint1)",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 3);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerArtsRepairYes');",
"            InjectAnswer('RepairYes', tstr1, 3);",
"        }",
"    }",
"    else",
"    {",
"        if(AnsCount <= 1)",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 3);",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + DeleteTags(CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerArtsRepairYes'));",
"            AddDialogBlock(tstr1, 1);",
"            InjectAnswer('RepairYes', tstr1, 3);",
"        }",
"    }",
"}",
"",
"tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairNo');",
"InjectAnswer('RepairNo', tstr1, 0);"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          222,
          "#":          225,
          "Total.Lines":          150,
          "Code.Type":"Turn",
          "Code":          
          [
"//Проверяем, сколько игрок потратил на ремонт в кредитах",
"check = GAnswerData;",
"if(abs(check) == 1) cost = item_cost;",
"else if(abs(check) == 2) cost = domik_wpn_cost;",
"else if(abs(check) == 3) cost = art_cost;",
"else if(abs(check) == 4) cost = total;",
"",
"//Оплата с личного счёта игрока",
"tint1 = 1; //Маркер проверки, согласился ли игрок произвести оплату с одного из счетов",
"if(CurRuinTypeStr != 'PlayerMB') ShipMoney(Player(), ShipMoney(Player()) - cost);",
"//Возможная оплата со счёта организации игрока",
"else if(ShipMoney(Player()) >= cost)",
"{",
"    tstr1 = CT('Script.Mod_ShuMercs.PlayerHQMainDialog.PlayerAccountPaymentOffer');",
"    if(PlayerHQMainArray['Finance', 'CurrentBalance'] >= cost) tstr1 = tstr1 + ' ' + CT('Script.Mod_ShuMercs.PlayerHQMainDialog.PlayerAccountPaymentOfferAdd');",
"",
"    if(MessageBoxYesNo(tstr1))",
"    {",
"        ShipMoney(Player(), ShipMoney(Player()) - cost);",
"    }",
"    else if(PlayerHQMainArray['Finance', 'CurrentBalance'] >= cost)",
"    {",
"        PlayerHQMainArray['Finance', 'CurrentBalance'] = PlayerHQMainArray['Finance', 'CurrentBalance'] - cost;",
"        PlayerHQMainArray['Finance', 'StatsOutEquipments'] = PlayerHQMainArray['Finance', 'StatsOutEquipments'] + cost;",
"    }",
"    else",
"    {",
"        tint1 = 0;",
"    }",
"}",
"else",
"{",
"    PlayerHQMainArray['Finance', 'CurrentBalance'] = PlayerHQMainArray['Finance', 'CurrentBalance'] - cost;",
"    PlayerHQMainArray['Finance', 'StatsOutEquipments'] = PlayerHQMainArray['Finance', 'StatsOutEquipments'] + cost;",
"}",
"",
"if(tint1)",
"{",
"    //Производим изъятие нодов из трюма и, если нужно, со склада",
"    if(nod_cost)",
"    {",
"        if(GetNodesFromShip(Player()) >= nod_cost) GetNodesFromShip(Player(), nod_cost);",
"        else",
"        {",
"            for(i = 1; i < ArrayDim(nodes_count_array); i = i + 1)",
"            {",
"                tint2 = ItemSize(nodes_count_array[i]) + GetNodesFromShip(Player());",
"                if(tint2 == nod_cost)",
"                {",
"                    GetNodesFromShip(Player(), GetNodesFromShip(Player()));",
"                    FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"                    break;",
"                }",
"                else if(tint2 > nod_cost)",
"                {",
"                    cur_item = GetItemFromStorage(FindItemInStorage(nodes_count_array[i]));",
"                    ItemSize(cur_item, ItemSize(cur_item) - (nod_cost - GetNodesFromShip(Player())));",
"                    GetNodesFromShip(Player(), GetNodesFromShip(Player()));",
"                    AddItemToStorage(GetShipRuins(Player()), cur_item);",
"                    break;",
"                }",
"                else",
"                {",
"                    nod_cost = nod_cost - tint2;",
"                    GetNodesFromShip(Player(), GetNodesFromShip(Player()));",
"                    FreeItem(GetItemFromStorage(FindItemInStorage(nodes_count_array[i])));",
"                }",
"            }",
"        }",
"    }",
"",
"    //Приступаем к непосредственному ремонту корпуса и вещей из списка",
"    for(i = 1; i < ArrayDim(items); i = i + 1)",
"    {",
"        cur_item = items[i];",
"        item_type = ItemType(cur_item);",
"        //check == 4 (или -4) - чиним всё",
"        if(abs(check) == 4)",
"        {",
"            if(item_type == t_Hull) HullHP(cur_ship, ItemSize(ShipItems(cur_ship, 0)));",
"            else ItemDurability(cur_item, 100);",
"        }",
"        //check == 1 (или -1) - чиним только стандартное",
"        else if(abs(check) == 1 && (item_type >= t_Hull && item_type <= t_CustomWeapon) || item_type == t_Satellite)",
"        {",
"            if(item_type == t_Hull) HullHP(cur_ship, ItemSize(ShipItems(cur_ship, 0)));",
"            else",
"            {",
"                if(item_type < t_Weapon13 || item_type > t_Weapon15)",
"                {",
"                    if(item_type != t_CustomWeapon) ItemDurability(cur_item, 100);",
"                    else if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') != 'NotSoldAndNodeRepair') ItemDurability(cur_item, 100);",
"                }",
"            }",
"        }",
"        //check == 2 (или -2) - чиним только нестандартное",
"        else if(abs(check) == 2)",
"        {",
"            if(item_type >= t_Weapon13 && item_type <= t_Weapon15) ItemDurability(cur_item, 100);",
"            else if(item_type == t_CustomWeapon)",
"            {",
"                if(GetCustomWeaponData(CustomWeaponType(cur_item), 'Availability') == 'NotSoldAndNodeRepair') ItemDurability(cur_item, 100);",
"            }",
"        }",
"        //check == 3 (или -3) - чиним только артефакты",
"        else if(abs(check) == 3 && item_type < t_Hull)",
"        {",
"            ItemDurability(cur_item, 100);",
"            tstr = 'ArtRep';",
"        }",
"    }",
"    Sound('Sound.Repair');",
"",
"    //Готовим финальную реплику в диалог",
"    if(SpecialRepairStr == 'ArtsRepair') tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ArtsRepairDone');",
"    else if(SpecialRepairStr == 'ProbesRepair') tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ProbesRepairDone');",
"    else",
"    {",
"        tstr1 = ShipType(cur_ship);",
"        if(cur_ship == Player())",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairDone');",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Tranclucator)",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancRepairDone');",
"        }",
"        else if(tstr1 == 'Merc' || tstr1 == 'Freelancer')",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercRepairDone');",
"        }",
"        else if(tstr1 == 'FemRanger')",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecRepairDone');",
"        }",
"        else if(tstr1 == 'Rebel')",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelRepairDone');",
"        }",
"        else if(ShipTypeN(cur_ship) == t_Pirate || tstr1 == 'RangerPirate' || tstr1 == 'RangerPirateExplorer')",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateRepairDone');",
"        }",
"        else",
"        {",
"            tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerRepairDone');",
"        }",
"        tstr1 = Format(tstr1, '<ShipName' + '>', ShipName(cur_ship), '<ShipFullName' + '>', Name(cur_ship));",
"    }",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          223,
          "#":          229,
          "Total.Lines":          43,
          "Code.Type":"Turn",
          "Code":          
          [
"//Готовим финальную реплику в диалог",
"if(SpecialRepairStr == 'ArtsRepair') tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ArtsRepairQuit');",
"else if(SpecialRepairStr == 'ProbesRepair') tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ProbesRepairQuit');",
"else",
"{",
"    tstr1 = ShipType(cur_ship);",
"    if(cur_ship == Player())",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PlayerSevereRepairQuit');",
"    }",
"    else if(ShipTypeN(cur_ship) == t_Tranclucator)",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.TrancSevereRepairQuit');",
"    }",
"    else if(tstr1 == 'Merc' || tstr1 == 'Freelancer')",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.MercSevereRepairQuit');",
"    }",
"    else if(tstr1 == 'FemRanger')",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.SpecSevereRepairQuit');",
"    }",
"    else if(tstr1 == 'Rebel')",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.RebelSevereRepairQuit');",
"    }",
"    else if(ShipTypeN(cur_ship) == t_Pirate || tstr1 == 'RangerPirate' || tstr1 == 'RangerPirateExplorer')",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PirateSevereRepairQuit');",
"    }",
"    else",
"    {",
"        if(!bad_equipments) tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerRepairQuit');",
"        else tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.PartnerSevereRepairQuit');",
"    }",
"    tstr1 = Format(tstr1, '<ShipName' + '>', ShipName(cur_ship), '<ShipFullName' + '>', Name(cur_ship));",
"}"          
          ]        
        },
        {
          "Type":"Top",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          213,
          "#":          231,
          "Total.Lines":          8,
          "Code.Type":"Turn",
          "Code":          
          [
"if(GAnswerData == 2)",
"{",
"    tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ArtsNoNeedInRepair');",
"}",
"else",
"{",
"    tstr1 = '</color>' + CT('Script.Mod_ExpRepair.' + CurRuinTypeStr + '.ProbesNoNeedInRepair');",
"}"          
          ]        
        }      
      ],
      "Planets":      
      [
        {
          "Type":"TPlanet",
          "Name":"PlanetNew",
          "Pos.x":          10,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          2,
          "Race":          62,
          "Owner":          62,
          "Economy":          14,
          "Goverment":          62,
          "RangeMin":          0,
          "RangeMax":          100,
          "Dialog":          -1        
        }      
      ],
      "Ships":      
      [
        {
          "Type":"TStarShip",
          "Name":"",
          "Pos.x":          10,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          0,
          "Count":          1,
          "Owner":          62,
          "Ship.Type":          126,
          "Player":true,
          "SpeedMin":          0,
          "SpeedMax":          10000,
          "Weapon":          0,
          "CargoHook":          0,
          "EmptySpace":          0,
          "StatusTraderMin":          0,
          "StatusTraderMax":          100,
          "StatusWarriorMin":          0,
          "StatusWarriorMax":          100,
          "StatusPirateMin":          0,
          "StatusPirateMax":          100,
          "StrengthMin":"0",
          "StrengthMax":"0",
          "Ruins":""        
        }      
      ],
      "Stars":      
      [
        {
          "Type":"TStar",
          "Name":"StarNew",
          "Pos.x":          10,
          "Pos.y":          150,
          "Parent":          -1,
          "#":          1,
          "Constellation":          0,
          "Priority":          0,
          "NoKling":false,
          "NoComeKling":false        
        }      
      ],
      "Statements":      
      [
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          15,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"item_cost || art_cost || domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          16,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!item_cost && !art_cost && !domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          80,
          "Parent":          -1,
          "#":          35,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost < 1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          36,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost < 1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          59,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!item_cost && !art_cost && !domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          400,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          60,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"item_cost || art_cost || domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          280,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          76,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!GAnswerData"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          190,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          77,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          280,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          78,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          190,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          79,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          430,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          80,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost > 0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          430,
          "Pos.y":          50,
          "Parent":          -1,
          "#":          82,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost > 0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          84,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost<1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          440,
          "Pos.y":          240,
          "Parent":          -1,
          "#":          85,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost>0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          300,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          88,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 2 || GAnswerData == 3"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          360,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          90,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          330,
          "Pos.y":          70,
          "Parent":          -1,
          "#":          92,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          610,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          96,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr == 'ArtRep' || tstr == 'ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          580,
          "Pos.y":          90,
          "Parent":          -1,
          "#":          97,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr!='ArtRep' && tstr!='ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          110,
          "Parent":          -1,
          "#":          102,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 4"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          310,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          110,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==2 || GAnswerData==3"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          250,
          "Parent":          -1,
          "#":          111,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==4"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          340,
          "Pos.y":          210,
          "Parent":          -1,
          "#":          114,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          370,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          118,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          610,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          121,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr=='ArtRep' || tstr=='ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          580,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          123,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr!='ArtRep' && tstr!='ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          230,
          "Parent":          -1,
          "#":          125,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost<1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          440,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          126,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost>0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          190,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          141,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          170,
          "Pos.y":          530,
          "Parent":          -1,
          "#":          142,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==4"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          260,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          143,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          290,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          145,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData==2 || GAnswerData==3"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          360,
          "Pos.y":          460,
          "Parent":          -1,
          "#":          148,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          310,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          149,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          630,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          161,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr=='ArtRep' || tstr=='ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          610,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          162,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"tstr!='ArtRep' && tstr!='ProbeRep'"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          410,
          "Pos.y":          440,
          "Parent":          -1,
          "#":          167,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!item_cost && !art_cost && !domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          410,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          170,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"item_cost || art_cost || domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          430,
          "Pos.y":          480,
          "Parent":          -1,
          "#":          173,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost>0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          490,
          "Parent":          -1,
          "#":          174,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!bad_equipments && nod_cost<1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          450,
          "Pos.y":          510,
          "Parent":          -1,
          "#":          175,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost<1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          430,
          "Pos.y":          520,
          "Parent":          -1,
          "#":          176,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"bad_equipments && nod_cost>0"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          198,
          "#":          199,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!item_cost && !art_cost && !domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          60,
          "Pos.y":          30,
          "Parent":          211,
          "#":          204,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!GAnswerData"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          30,
          "Parent":          211,
          "#":          205,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 4"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          40,
          "Pos.y":          30,
          "Parent":          211,
          "#":          206,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 2 || GAnswerData == 3"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          211,
          "#":          207,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"GAnswerData == 1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          209,
          "#":          212,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          30,
          "Parent":          209,
          "#":          213,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!art_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          30,
          "Parent":          210,
          "#":          218,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"item_cost || art_cost || domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          20,
          "Pos.y":          20,
          "Parent":          198,
          "#":          234,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"item_cost || art_cost || domik_wpn_cost"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          50,
          "Parent":          234,
          "#":          235,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"1"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          -20,
          "Pos.y":          0,
          "Parent":          225,
          "#":          236,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!check"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          20,
          "Parent":          225,
          "#":          237,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"check"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          -170,
          "Parent":          236,
          "#":          238,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"!IsPlayer(cur_ship)"          
          ]        
        },
        {
          "Type":"Tif",
          "Name":"",
          "Pos.x":          0,
          "Pos.y":          -140,
          "Parent":          236,
          "#":          239,
          "Total.Lines":          1,
          "Code.Type":"Turn",
          "Code":          
          [
"IsPlayer(cur_ship)"          
          ]        
        }      
      ],
      "States":      
      [
        {
          "Type":"TState",
          "Name":"PlayerState",
          "Pos.x":          10,
          "Pos.y":          240,
          "Parent":          -1,
          "#":          4,
          "Move":          0,
          "MoveObj":          -1,
          "Attack.Count":          0,
          "TakeItem":          -1,
          "TakeAllItem":false,
          "OnTalk":"",
          "OnActCode":"",
          "EType":          1,
          "EUnique":"",
          "EMsg":""        
        }      
      ],
      "Variables":      
      [
        {
          "Type":"TVar",
          "Name":"i",
          "Pos.x":          790,
          "Pos.y":          360,
          "Parent":          -1,
          "#":          24,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"cur_ship",
          "Pos.x":          740,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          25,
          "Var.Type":"Dword",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"cur_item",
          "Pos.x":          740,
          "Pos.y":          140,
          "Parent":          -1,
          "#":          26,
          "Var.Type":"Dword",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tint",
          "Pos.x":          740,
          "Pos.y":          360,
          "Parent":          -1,
          "#":          27,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"art_cost",
          "Pos.x":          740,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          28,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"nod_cost",
          "Pos.x":          740,
          "Pos.y":          100,
          "Parent":          -1,
          "#":          29,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"item_cost",
          "Pos.x":          740,
          "Pos.y":          80,
          "Parent":          -1,
          "#":          30,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"cost",
          "Pos.x":          740,
          "Pos.y":          320,
          "Parent":          -1,
          "#":          31,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"max_duration",
          "Pos.x":          740,
          "Pos.y":          60,
          "Parent":          -1,
          "#":          32,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"domik_wpn_cost",
          "Pos.x":          740,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          33,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"total",
          "Pos.x":          740,
          "Pos.y":          280,
          "Parent":          -1,
          "#":          34,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"bad_equipments",
          "Pos.x":          740,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          39,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tstr",
          "Pos.x":          850,
          "Pos.y":          280,
          "Parent":          -1,
          "#":          40,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"ship",
          "Pos.x":          740,
          "Pos.y":          300,
          "Parent":          -1,
          "#":          46,
          "Var.Type":"Unknown",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"items",
          "Pos.x":          740,
          "Pos.y":          220,
          "Parent":          -1,
          "#":          47,
          "Var.Type":"Unknown",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"variable",
          "Pos.x":          740,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          48,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tstr2",
          "Pos.x":          850,
          "Pos.y":          320,
          "Parent":          -1,
          "#":          49,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"discount",
          "Pos.x":          740,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          72,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"bad_equipments_count",
          "Pos.x":          740,
          "Pos.y":          0,
          "Parent":          -1,
          "#":          73,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"DefSplt",
          "Pos.x":          740,
          "Pos.y":          -30,
          "Parent":          -1,
          "#":          87,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"AddText",
          "Pos.x":          850,
          "Pos.y":          20,
          "Parent":          -1,
          "#":          99,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"TrankRep",
          "Pos.x":          850,
          "Pos.y":          80,
          "Parent":          -1,
          "#":          101,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"AddTextNodes",
          "Pos.x":          850,
          "Pos.y":          40,
          "Parent":          -1,
          "#":          107,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"AnsCount",
          "Pos.x":          850,
          "Pos.y":          100,
          "Parent":          -1,
          "#":          108,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"nod_cost_float",
          "Pos.x":          850,
          "Pos.y":          120,
          "Parent":          -1,
          "#":          129,
          "Var.Type":"Float",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"discount_float",
          "Pos.x":          850,
          "Pos.y":          140,
          "Parent":          -1,
          "#":          130,
          "Var.Type":"Float",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"nodes_count_total",
          "Pos.x":          850,
          "Pos.y":          160,
          "Parent":          -1,
          "#":          131,
          "Var.Type":"Int",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"nodes_count_array",
          "Pos.x":          850,
          "Pos.y":          180,
          "Parent":          -1,
          "#":          132,
          "Var.Type":"Unknown",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"temp_dword",
          "Pos.x":          850,
          "Pos.y":          200,
          "Parent":          -1,
          "#":          133,
          "Var.Type":"Dword",
          "Init":"0",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"item_type",
          "Pos.x":          850,
          "Pos.y":          220,
          "Parent":          -1,
          "#":          182,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"cur_ruin",
          "Pos.x":          850,
          "Pos.y":          260,
          "Parent":          -1,
          "#":          186,
          "Var.Type":"Dword",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tstr1",
          "Pos.x":          850,
          "Pos.y":          300,
          "Parent":          -1,
          "#":          187,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"check",
          "Pos.x":          850,
          "Pos.y":          360,
          "Parent":          -1,
          "#":          203,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"CurRuinTypeStr",
          "Pos.x":          740,
          "Pos.y":          -90,
          "Parent":          -1,
          "#":          217,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"IndentStr",
          "Pos.x":          740,
          "Pos.y":          -70,
          "Parent":          -1,
          "#":          224,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"SpecialRepairStr",
          "Pos.x":          740,
          "Pos.y":          -50,
          "Parent":          -1,
          "#":          228,
          "Var.Type":"Str",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tint1",
          "Pos.x":          740,
          "Pos.y":          380,
          "Parent":          -1,
          "#":          232,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"tint2",
          "Pos.x":          740,
          "Pos.y":          400,
          "Parent":          -1,
          "#":          233,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"non_standard_repair",
          "Pos.x":          850,
          "Pos.y":          380,
          "Parent":          -1,
          "#":          240,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        },
        {
          "Type":"TVar",
          "Name":"max_durability_to_repair",
          "Pos.x":          850,
          "Pos.y":          400,
          "Parent":          -1,
          "#":          241,
          "Var.Type":"Int",
          "Init":"",
          "Global":false        
        }      
      ]    
    }  
  ],
  "Visual.Links":  
  [
    {
      "Type":"TGraphLink",
      "Begin":      3,
      "End":      4,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      3,
      "End":      2,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      2,
      "End":      1,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      0,
      "End":      1,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      6,
      "End":      7,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      7,
      "End":      8,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      10,
      "End":      12,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      12,
      "End":      14,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      14,
      "End":      15,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      13,
      "End":      15,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      13,
      "End":      16,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      14,
      "End":      16,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      15,
      "End":      17,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      18,
      "End":      19,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      35,
      "End":      37,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      36,
      "End":      38,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      17,
      "End":      35,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      17,
      "End":      36,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      42,
      "End":      20,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      37,
      "End":      43,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      38,
      "End":      43,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      50,
      "End":      51,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      51,
      "End":      52,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      54,
      "End":      55,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      55,
      "End":      57,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      57,
      "End":      60,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      58,
      "End":      59,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      60,
      "End":      61,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      64,
      "End":      65,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      62,
      "End":      63,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      57,
      "End":      59,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      58,
      "End":      60,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      66,
      "End":      67,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      67,
      "End":      68,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      8,
      "End":      9,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      52,
      "End":      53,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      81,
      "End":      43,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      17,
      "End":      80,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      80,
      "End":      81,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      17,
      "End":      82,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      82,
      "End":      83,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      83,
      "End":      43,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      61,
      "End":      84,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      61,
      "End":      85,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      85,
      "End":      64,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      84,
      "End":      86,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      86,
      "End":      65,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      75,
      "End":      11,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      11,
      "End":      76,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      76,
      "End":      14,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      11,
      "End":      77,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      77,
      "End":      13,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      11,
      "End":      88,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      88,
      "End":      89,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      89,
      "End":      90,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      90,
      "End":      91,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      91,
      "End":      19,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      89,
      "End":      92,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      92,
      "End":      93,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      93,
      "End":      94,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      94,
      "End":      95,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      44,
      "End":      97,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      44,
      "End":      96,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      16,
      "End":      100,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      100,
      "End":      18,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      11,
      "End":      102,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      102,
      "End":      103,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      103,
      "End":      16,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      103,
      "End":      15,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      97,
      "End":      105,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      105,
      "End":      45,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      98,
      "End":      106,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      20,
      "End":      106,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      45,
      "End":      106,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      106,
      "End":      21,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      41,
      "End":      42,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      59,
      "End":      109,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      109,
      "End":      62,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      78,
      "End":      57,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      56,
      "End":      78,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      74,
      "End":      56,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      56,
      "End":      79,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      79,
      "End":      58,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      115,
      "End":      116,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      117,
      "End":      115,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      114,
      "End":      117,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      113,
      "End":      114,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      110,
      "End":      113,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      56,
      "End":      110,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      56,
      "End":      111,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      111,
      "End":      112,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      112,
      "End":      60,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      112,
      "End":      59,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      113,
      "End":      118,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      118,
      "End":      119,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      119,
      "End":      63,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      68,
      "End":      120,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      71,
      "End":      120,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      120,
      "End":      69,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      70,
      "End":      123,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      123,
      "End":      124,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      124,
      "End":      71,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      70,
      "End":      121,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      122,
      "End":      120,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      61,
      "End":      125,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      61,
      "End":      126,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      126,
      "End":      128,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      125,
      "End":      127,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      128,
      "End":      65,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      127,
      "End":      65,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      134,
      "End":      135,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      135,
      "End":      136,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      136,
      "End":      137,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      139,
      "End":      140,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      140,
      "End":      141,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      140,
      "End":      142,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      138,
      "End":      144,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      140,
      "End":      143,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      140,
      "End":      145,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      144,
      "End":      146,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      143,
      "End":      146,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      145,
      "End":      147,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      147,
      "End":      149,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      147,
      "End":      148,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      149,
      "End":      150,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      150,
      "End":      151,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      151,
      "End":      152,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      142,
      "End":      153,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      148,
      "End":      154,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      155,
      "End":      157,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      157,
      "End":      158,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      158,
      "End":      159,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      159,
      "End":      163,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      156,
      "End":      161,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      156,
      "End":      162,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      162,
      "End":      164,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      164,
      "End":      160,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      165,
      "End":      159,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      154,
      "End":      166,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      160,
      "End":      159,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      146,
      "End":      167,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      167,
      "End":      168,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      168,
      "End":      169,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      169,
      "End":      166,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      146,
      "End":      170,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      141,
      "End":      171,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      171,
      "End":      167,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      171,
      "End":      170,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      153,
      "End":      170,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      153,
      "End":      167,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      170,
      "End":      172,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      172,
      "End":      173,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      172,
      "End":      174,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      172,
      "End":      175,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      172,
      "End":      176,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      173,
      "End":      180,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      176,
      "End":      179,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      175,
      "End":      178,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      174,
      "End":      177,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      177,
      "End":      181,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      180,
      "End":      181,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      179,
      "End":      181,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      178,
      "End":      181,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      96,
      "End":      183,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      183,
      "End":      98,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      121,
      "End":      184,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      184,
      "End":      122,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      161,
      "End":      185,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      185,
      "End":      165,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      104,
      "End":      188,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      188,
      "End":      189,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      189,
      "End":      190,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      191,
      "End":      192,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      192,
      "End":      193,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      193,
      "End":      194,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      196,
      "End":      197,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      197,
      "End":      198,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      198,
      "End":      199,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      199,
      "End":      200,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      200,
      "End":      201,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      201,
      "End":      202,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      205,
      "End":      208,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      206,
      "End":      209,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      207,
      "End":      210,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      204,
      "End":      198,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      195,
      "End":      211,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      211,
      "End":      204,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      211,
      "End":      207,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      211,
      "End":      206,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      211,
      "End":      205,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      209,
      "End":      212,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      209,
      "End":      213,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      212,
      "End":      214,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      214,
      "End":      215,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      215,
      "End":      216,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      210,
      "End":      218,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      210,
      "End":      199,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      208,
      "End":      199,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      208,
      "End":      218,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      218,
      "End":      219,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      219,
      "End":      220,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      220,
      "End":      221,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      222,
      "End":      225,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      226,
      "End":      227,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      223,
      "End":      229,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      229,
      "End":      230,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      230,
      "End":      227,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      213,
      "End":      231,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      231,
      "End":      201,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      198,
      "End":      234,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      235,
      "End":      219,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      234,
      "End":      235,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      225,
      "End":      237,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      237,
      "End":      226,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      225,
      "End":      236,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      236,
      "End":      239,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      236,
      "End":      238,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      239,
      "End":      211,
      "Nom":      0,
      "Arrow":true    
    },
    {
      "Type":"TGraphLink",
      "Begin":      238,
      "End":      197,
      "Nom":      0,
      "Arrow":true    
    }  
  ],
  "Rect.Text":  
  [
    {
      "Type":"TGraphRectText",
      "Rect.Left":      106,
      "Rect.Top":      -16,
      "Rect.Right":      728,
      "Rect.Bottom":      124,
      "FStyle":      1,
      "FColor":      10710818,
      "BStyle":      0,
      "BColor":      14474460,
      "BSize":      1,
      "BCoef":"0,300000011920929",
      "AlignX":      1,
      "AlignY":      1,
      "AlignRect":false,
      "Text":"Ремонт на НБ   ",
      "Color":      0,
      "Font":"Arial",
      "FontSize":      10,
      "fsBold":false,
      "fsItalic":false,
      "fsUnderline":false    
    },
    {
      "Type":"TGraphRectText",
      "Rect.Left":      106,
      "Rect.Top":      124,
      "Rect.Right":      728,
      "Rect.Bottom":      264,
      "FStyle":      1,
      "FColor":      10710818,
      "BStyle":      0,
      "BColor":      14474460,
      "BSize":      1,
      "BCoef":"0,300000011920929",
      "AlignX":      1,
      "AlignY":      1,
      "AlignRect":false,
      "Text":"Ремонт на ПБ   ",
      "Color":      0,
      "Font":"Arial",
      "FontSize":      10,
      "fsBold":false,
      "fsItalic":false,
      "fsUnderline":false    
    },
    {
      "Type":"TGraphRectText",
      "Rect.Left":      106,
      "Rect.Top":      -299,
      "Rect.Right":      728,
      "Rect.Bottom":      -15,
      "FStyle":      1,
      "FColor":      10710818,
      "BStyle":      0,
      "BColor":      14474460,
      "BSize":      1,
      "BCoef":"0,300000011920929",
      "AlignX":      0,
      "AlignY":      0,
      "AlignRect":false,
      "Text":"Все расчёты стоимости ремонта предметов производятся по формулам:\r\nRound10((FCost div 40) / 100 * damageProc + 10);\r\ndamageProc := 100 / (self as THull).FSize * ((self as THull).FSize - (self as THull).FHitPoints);\r\nдля корпуса\r\n\r\nRound10((FCost div 20) + (FCost div 7 / 100 * (100 - Round(FDuration))) + 10)\r\nдля простых вещей\r\n\r\nRound10((FCost div 10) + (FCost div 5 / 100 * (100 - Round(FDuration))) + 10)\r\nдля артефактов (умножается на 2, после возможного наложения штрафа за сломанный предмет)\r\n\r\nПосле этого на получившееся число накладывается модификатор:\r\n1.3 - если вещь сломана\r\n0.84 - если ремонт предлагает ПБ (и потом ещё сверху скидка)\r\nот 0.9 до 0.2 (в зависимости от звания игрока) - если ремонт предлагает ВБ\r\n\r\nПриведённые выше формулы в функциях были переведены на скриптовый язык",
      "Color":      0,
      "Font":"Arial",
      "FontSize":      10,
      "fsBold":false,
      "fsItalic":false,
      "fsUnderline":false    
    },
    {
      "Type":"TGraphRectText",
      "Rect.Left":      106,
      "Rect.Top":      404,
      "Rect.Right":      728,
      "Rect.Bottom":      547,
      "FStyle":      1,
      "FColor":      10710818,
      "BStyle":      0,
      "BColor":      14474460,
      "BSize":      1,
      "BCoef":"0,300000011920929",
      "AlignX":      1,
      "AlignY":      1,
      "AlignRect":false,
      "Text":"Ремонт на ТЦ   ",
      "Color":      0,
      "Font":"Arial",
      "FontSize":      10,
      "fsBold":false,
      "fsItalic":false,
      "fsUnderline":false    
    }  
  ],
  "BlockPar.EC.Total.Strings":  137,
  "BlockPar.EC":  
  [
    {
      "#":"103",
      "String":"</color>Ваш транклюкатор"    
    },
    {
      "#":"104",
      "String":"</color>Корабль вашего напарника"    
    },
    {
      "#":"105",
      "String":"Чинить <0>"    
    },
    {
      "#":"108",
      "String":"Сейчас пока ничего, извините"    
    },
    {
      "#":"11",
      "String":"Почините стандартное оборудование"    
    },
    {
      "#":"112",
      "String":"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Вы вообще не боитесь на нём летать?"    
    },
    {
      "#":"113",
      "String":"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние транклюкатора и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить своего помощника? Вы вообще не боитесь выпускать его в космос?"    
    },
    {
      "#":"114",
      "String":"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Ваш напарник вообще не боится на нём летать?"    
    },
    {
      "#":"115",
      "String":"</color>Ваш корабль, <Player>,"    
    },
    {
      "#":"129",
      "String":"<0> Были рады помочь вам, рейнджер <Player>."    
    },
    {
      "#":"130",
      "String":"<0>"    
    },
    {
      "#":"133",
      "String":"</color>Корабль наёмника"    
    },
    {
      "#":"134",
      "String":"Сейчас посмотрим...<br>...<br><0> в отличном состоянии и не требует ремонта."    
    },
    {
      "#":"137",
      "String":"Ох, очень жаль... В смысле, мы рады, что ваш корабль в полном порядке!<br>Но если вдруг что-то сломается - обязательно прилетайте к нам. Такого качественного обслуживания вы не найдёте больше нигде в Галактике!"    
    },
    {
      "#":"139",
      "String":"Чинить текущее оборудование"    
    },
    {
      "#":"170",
      "String":"Оплачиваю только нестандартный ремонт"    
    },
    {
      "#":"171",
      "String":"Плачу только за стандартное оборудование"    
    },
    {
      "#":"184",
      "String":"Согласен оплатить полный ремонт"    
    },
    {
      "#":"185",
      "String":"</color>Так, так... Всё разбито, поизносилось... Итого имеем... Ужасное состояние корабля и всего оборудования!<br>Такой ремонт вам встанет в копеечку. И как можно было так запустить свой корабль? Ох уж эти наёмники - бесстрашные ребята!"    
    },
    {
      "#":"194",
      "String":"Пожалуй, ремонта артефактов будет вполне достаточно"    
    },
    {
      "#":"198",
      "String":"Чинить оборудование рейнджера <0>"    
    },
    {
      "#":"208",
      "String":"Сейчас пока ничего не надо"    
    },
    {
      "#":"220",
      "String":"По рукам!"    
    },
    {
      "#":"229",
      "String":"</color>гаалец"    
    },
    {
      "#":"231",
      "String":"</color>человек"    
    },
    {
      "#":"232",
      "String":"</color>пеленг"    
    },
    {
      "#":"233",
      "String":"</color>малок"    
    },
    {
      "#":"249",
      "String":"Сейчас посмотрим...<br>...<br><0><br><br>Вот наша калькуляция:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Ремонт артефактов: <4><5> cr.<br><6><br>Итого: <7><8> cr.<br><br>Согласен, много - а что поделаешь? Поломок-то ведь тьма тьмущая!"    
    },
    {
      "#":"250",
      "String":"Сейчас посмотрим...<br>...<br>Так, так... Есть некоторые поломки, мы всё это устраним за символическую плату. О'кей?<br><br>Смотрите, вот наша калькуляция:<br><0><br>Ремонт оборудования: <1><2> cr.<br>Ремонт артефактов: <3><4> cr.<br><5><br>Итого: <6><7> cr."    
    },
    {
      "#":"257",
      "String":"Сейчас посмотрим...<br>...<br>Так, так... Есть небольшие поломки... Ого, а вот это уже посерьёзнее! Но в целом ничего страшного.<br>Мы легко восстановим все ваши артефакты всего за <0> cr. Договорились?"    
    },
    {
      "#":"269",
      "String":"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии."    
    },
    {
      "#":"270",
      "String":"</color>И кстати, чуть не забыл! Ребята нашли в транке особые доминаторские пушки, а для их ремонта по-любому потребуются ноды. С этим уж извиняй - особенности жестяночной технологии."    
    },
    {
      "#":"271",
      "String":"</color>Твой транк и так в отличном состоянии, ремонт ему не нужен."    
    },
    {
      "#":"291",
      "String":"Плачу только за особые пушки"    
    },
    {
      "#":"292",
      "String":"Тьфу ты, блин! А я уж было обрадовался - думал, погуляем сегодня вечером с ребятами после трудового дня... Нехороший ты <0>, <Player> - жадный.<br>А артефакты, между прочим, нормальным пацанам в космосе жизни спасают! Но ты лети... Как говорится, в добрый путь."    
    },
    {
      "#":"392",
      "String":"Слушай, <Player>, харе мозги пудрить, а? Не нужен тебе ремонт - так не отвлекай людей от дела, а нужен - так тащи сюда своё барахло, да поживее!"    
    },
    {
      "#":"408",
      "String":"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только тебя на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <0> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"410",
      "String":"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего наёмника на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <0> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"411",
      "String":"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего братана на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <0> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"417",
      "String":"</color>Корабль твоего наёмника в полном порядке, ремонт ему не требуется."    
    },
    {
      "#":"418",
      "String":"</color>Корабль твоего братана в полном порядке. Прилетайте, как из-под капота застучит, хе-хе."    
    },
    {
      "#":"419",
      "String":"А ну-ка сейчас заценим...<br>...<br><0>"    
    },
    {
      "#":"42",
      "String":"Спасибо, но я передумал"    
    },
    {
      "#":"422",
      "String":"А ну-ка сейчас заценим...<br>...<br>Ну вот что, <Player> - по нашим расценкам полный ремонт всех твоих побрякушек тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>.<br>С этой скидкой весь ремонт тебе встанет в <2> cr. По рукам?"    
    },
    {
      "#":"423",
      "String":"А ну-ка сейчас заценим...<br>...<br>Похоже, что все твои артефакты в полном порядке. Возвращайся, как до чёрных дыр затаскаешь, хе-хе."    
    },
    {
      "#":"432",
      "String":"А ну-ка сейчас заценим...<br>...<br><0><br><1><br><br>Вот наша цена со скидкой:<br><2><br>Ремонт оборудования: <3><4> cr.<br>Ремонт особых пушек: <5><6> cr.<br>Доп. материалы: <7><8> нд.<br>Ремонт артефактов: <9><10> cr.<br><11><br>Всего: <12><13> cr. и <14> нд.<br><br>Понимаю, цифры недетские, ну так и технику с того света возвращать - задача не из лёгких. Так что, по рукам?"    
    },
    {
      "#":"433",
      "String":"А ну-ка сейчас заценим...<br>...<br><0><br><br>Вот наша цена со скидкой:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Ремонт артефактов: <4><5> cr.<br><6><br>Всего: <7><8> cr.<br><br>Так что, по рукам?"    
    },
    {
      "#":"434",
      "String":"А ну-ка сейчас заценим...<br>...<br><0><br><br>Вот наша цена со скидкой:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Ремонт артефактов: <4><5> cr.<br><6><br>Всего: <7><8> cr.<br><br>Понимаю, цифры недетские, ну так и технику с того света возвращать - задача не из лёгких. Так что, по рукам?"    
    },
    {
      "#":"435",
      "String":"А ну-ка сейчас заценим...<br>...<br><0><br><1><br><br>Вот наша цена со скидкой:<br><2><br>Ремонт оборудования: <3><4> cr.<br>Ремонт особых пушек: <5><6> cr.<br>Доп. материалы: <7><8> нд.<br>Ремонт артефактов: <9><10> cr.<br><11><br>Всего: <12><13> cr. и <14> нд.<br><br>Так что, по рукам?"    
    },
    {
      "#":"443",
      "String":"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только он у тебя ещё от звёздного ветра не рассыпался?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <0> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"446",
      "String":"Как знать, как знать, <Player>, ведь экономия на артефактах может привести к весьма непредсказуемым и крайне малоприятным последствиям...<br>Вот вы, например, слышали историю про рейнджера Гуули-Фера, которого собственные чрезмерно развившиеся нанитоиды привязали к пилотскому креслу, а его корабль направили в доминаторскую систему, дабы там примкнуть к \"освободительному движению машин\"?<br>А про рейнджера Мюнхайзе, прославившегося своим невероятным полётом на энергоядре, случившемся после того, как его пробитый в бою локализатор взрывной волны локализовал эту самую волну прямо посреди инженерного отсека?<br>То-то же!"    
    },
    {
      "#":"447",
      "String":"Чинить оборудование повстанца <0>"    
    },
    {
      "#":"448",
      "String":"</color>Ни хрена себе развалюха! Да наша база и та в лучшей форме! И как только твоего чегевара на посадке не расколошматило?!<br>Короче, смотри... В обычной ситуации всё это страхолюдие мы бы поправили за <0> cr., но, с учётом твоего пиратского рейтинга, так уж и быть, сделаем скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"455",
      "String":"Чинить всё"    
    },
    {
      "#":"462",
      "String":"</color>Корабль твоего чегевара в полном порядке, ремонт требуется только его мозгам."    
    },
    {
      "#":"463",
      "String":"</color>фэянин"    
    },
    {
      "#":"474",
      "String":"Спасибо, но цена уж слишком велика"    
    },
    {
      "#":"475",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Хмм, ну, вроде, ничего серьёзного. Всё устраним и восстановим за <0> cr.<br>Могли бы дешевле, да только за лицензию с нас \"научники\" и так по три шкуры дерут - жлобяры!"    
    },
    {
      "#":"477",
      "String":"Да ну тьфу-ты, ну! Ещё один сорвался!<br>Говорил я им - слишком дорого берёте, пенчекряки! Дайте процент ниже - больше народу привлечём, а на обороте ещё лучшую прибыль сделаем, ну так ведь нет! Им, видите ли, престиж работы важнее, статус учёного, едрить его в качель!<br>Ох, чую, наплачемся мы ещё с этой лицензией. А вы извините, <Player>. Лично к вам у меня никаких претензий."    
    },
    {
      "#":"481",
      "String":"Я передумал, ремонт мне не нужен"    
    },
    {
      "#":"484",
      "String":"</color>Твоя \"птичка\" в отличном состоянии, <Player>, ремонт ей не нужен."    
    },
    {
      "#":"493",
      "String":"</color>ваш корабль"    
    },
    {
      "#":"494",
      "String":"</color>ваш транклюкатор"    
    },
    {
      "#":"495",
      "String":"</color>корабль наёмника"    
    },
    {
      "#":"496",
      "String":"</color>корабль вашего напарника"    
    },
    {
      "#":"506",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br><0><br><br>Вот полная стоимость работ:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Ремонт артефактов: <4><5> cr.<br><6><br>Итого: <7><8> cr.<br><br>Да, недёшево, однако и работы тут непочатый край - уж не обессудьте."    
    },
    {
      "#":"513",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Похоже, <0> в отличном состоянии и не требует ремонта."    
    },
    {
      "#":"514",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Да, похоже, кое-что и, правда, поломалось, но ничего серьёзного. Исправим в считанные часы.<br><br>Вот полная стоимость работ:<br><0><br>Ремонт оборудования: <1><2> cr.<br>Ремонт артефактов: <3><4> cr.<br><5><br>Итого: <6><7> cr."    
    },
    {
      "#":"516",
      "String":"</color>Да, и ещё. На вашем корабле установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>."    
    },
    {
      "#":"517",
      "String":"</color>Да, и ещё. На транклюкаторе установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>."    
    },
    {
      "#":"518",
      "String":"</color>Да, и ещё. На корабле наёмника установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>."    
    },
    {
      "#":"519",
      "String":"</color>Да, и ещё. На корабле вашего напарника установлено нестандартное оборудование. Для его ремонта нам потребуются дополнительные материалы, а именно - <clr>ноды<clrEnd>."    
    },
    {
      "#":"520",
      "String":"</color>И кстати, чуть не забыл! Ребята нашли на борту особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии."    
    },
    {
      "#":"521",
      "String":"</color>И кстати, чуть не забыл! Ребята нашли в транке особые доминаторские пушки, а для их ремонта по-любому потребуются <clr>ноды<clrEnd>. С этим уж извиняй - особенности жестяночной технологии."    
    },
    {
      "#":"522",
      "String":"</color>Только хочу предупредить сразу - на вашем корабле мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>."    
    },
    {
      "#":"523",
      "String":"</color>Ууу... Да тут работы надолго! И как это вас угораздило так запустить свой корабль, <Player>?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький!"    
    },
    {
      "#":"524",
      "String":"</color>Только хочу предупредить сразу - на транклюкаторе мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>."    
    },
    {
      "#":"525",
      "String":"</color>Ууу... Да тут работы надолго! И как это вас угораздило так запустить своего транклюкатора, <Player>?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький!"    
    },
    {
      "#":"526",
      "String":"</color>Только хочу предупредить сразу - на корабле наёмника мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>."    
    },
    {
      "#":"527",
      "String":"</color>Ууу... Да тут работы надолго! И как этого наёмника угораздило так запустить свой корабль?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький! Корабль - не наёмник."    
    },
    {
      "#":"528",
      "String":"</color>Только хочу предупредить сразу - на корабле вашего напарника мы нашли нестандартные оборудование, которое просто так не починишь. Придётся использовать <clr>ноды<clrEnd>."    
    },
    {
      "#":"529",
      "String":"</color>Ууу... Да тут работы надолго! И как вашего напарника угораздило так запустить свой корабль?<br>Впрочем, не извольте беспокоиться. Когда мы с ним закончим - будет сиять как новенький! Корабль - не напарник."    
    },
    {
      "#":"530",
      "String":"Эх, расстроили вы меня, <Player>! Только собирался отдать команду на полный техосмотр, а вам и ремонт то, оказывается, не нужен был.<br>Наш центр ведь буквально живёт такими ремонтами, понимаете? А без ключа да кувалды в руках, какой вообще в жизни смысл?"    
    },
    {
      "#":"531",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Похоже, все ваши артефакты в отличной кондиции, и ремонта не требуют."    
    },
    {
      "#":"541",
      "String":"Чинить оборудование спецагента <0>"    
    },
    {
      "#":"543",
      "String":"Чинить зонды"    
    },
    {
      "#":"544",
      "String":"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Все ваши зонды теперь как новенькие!"    
    },
    {
      "#":"545",
      "String":"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Все артефакты теперь как новенькие!"    
    },
    {
      "#":"546",
      "String":"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Осмотрите транклюкатора - оцените результат. Ни единой царапины!"    
    },
    {
      "#":"547",
      "String":"Отлично, деньги уже сняты с вашего счёта, а наши техники уже почти закончили работу.<br>Зайдите на корабль и оцените результат. Ни единой царапины!"    
    },
    {
      "#":"548",
      "String":"Ну, это вам сейчас кажется, что неприемлемо. А как сядут на хвост пираты, пробьют топливный бак, и двигатель откажет в бою... Что тогда станете делать, <Player>?<br>Лучше починить всё сразу, чтобы не попасть в такую ситуацию."    
    },
    {
      "#":"549",
      "String":"Напрасно вы отказываетесь от ремонта своего транклюкатора. Отличная машина, а главное - полезная и послушная. Он ведь вас и в бою прикроет, и вещи со всей системы для вас соберёт...<br>Не цените вы, <Player>, хорошей робототехники. Наверное, потому и рейнджер."    
    },
    {
      "#":"550",
      "String":"Даром что наёмник, но ведь он живой гуманоид, <Player>! Неужели вам ничуть не жаль своих телохранителей?<br>Ну не о нём, так о себе подумайте, ведь наёмник - ваш надёжный щит! Вот сядут вам на хвост пираты... А, впрочем, чего я на вас время трачу..."    
    },
    {
      "#":"551",
      "String":"Оно, <Player>, конечно, может и разумно... Ну подумаешь, наёмник, чего на него лишние деньги тратить? Вот только в перестрелке надёжнее этих ребят вы вряд ли кого встретите, так что настоятельно рекомендую пересмотреть инвестиционные приоритеты."    
    },
    {
      "#":"552",
      "String":"Очень неразумно экономить на своём напарнике, <Player>. Вот сядут вам на хвост пираты - напарника под удар подставить может и удастся, но так ведь потом и до вас очередь дойдёт! А представьте, что будет, если напарник из той передряги всё же выберется?<br>Уж лучше слегка переплатить за ремонт, чем попасть в такую ситуацию."    
    },
    {
      "#":"553",
      "String":"Что ж, дело ваше, <Player>. Искренне желаю удачи в изучении планет с неисправными зондами."    
    },
    {
      "#":"554",
      "String":"Ну вот и славно! Твои бабки мы уже списали, а ремонт закончим с минуты на минуту.<br>Ступай на корабль, <Player> - принимай работу!"    
    },
    {
      "#":"555",
      "String":"Ну вот и славно! Твои бабки мы уже списали, а ремонт закончим с минуты на минуту.<br>Иди проверь транка, <Player> - оцени работу!"    
    },
    {
      "#":"556",
      "String":"Ну ты и жлобяра, <Player>, зажал бабки на ремонт!<br>А ну как в следующей системе на жестянок напорешься? Отделают тебя электроники как Сидорову козу, вот увидишь!"    
    },
    {
      "#":"557",
      "String":"Эх, <Player>! Не знаешь ты цены хорошему транклюкатору...<br>Ведь это же настоящее чудо инженерной техники! Вот сам посуди: денег за службу не требует, собранные вещички сам без базара отдаёт... Не напарник - сказка.<br>Чинил бы лучше, пока он у тебя кукухой не тронулся, да к ближайшей звезде на полной скорости не рванул!"    
    },
    {
      "#":"558",
      "String":"Я, <Player>, конечно, и сам этих чегеваров не перевариваю, уж больно они все на своих идеях двинутые. Но ты всё же подумай ещё разок - а ну как этот либертарианец в бою пригодится? Так-то они парни горячие."    
    },
    {
      "#":"559",
      "String":"Понимаю тебя, <Player>, пусть лучше эти наёмники сами себя ремонтом и обеспечивают, чай не нищие.<br>Но если вдруг передумаешь - милости просим в рем-док. Уж нам с ребятами лишние кредиты точно не помешают."    
    },
    {
      "#":"560",
      "String":"Не по понятиям, <Player>, братану в нужде отказывать! Вот сегодня ты его на ремонт прокатишь, а завтра что? А я тебе скажу, что завтра. Завтра, <Player>, ты один, уже без братана, с голой кормой ввяжешься в неравный бой, да в том же бою безвестно и сгинешь!<br>Подумай-ка ещё разок - надо оно тебе, или может лучше сейчас переплатить, чем потом с космической пылью промеж звёзд хороводы накручивать."    
    },
    {
      "#":"561",
      "String":"А, ну дело твоё. Со сломанными зондами, правда, много не наизучаешь, но если подкинешь мне пару кредитов, могу тебе из личных запасов лупу выделить. Так сказать, для компенсации технического и умственного отставания в развитии, хе-хе."    
    },
    {
      "#":"575",
      "String":"А ну-ка сейчас заценим...<br>...<br>Похоже, что все твои зонды в полном порядке. Возвращайся, как на лету рассыпаться начнут, хе-хе."    
    },
    {
      "#":"576",
      "String":"Сейчас посмотрим...<br>...<br>Так, так... Есть небольшие поломки... Ого, а вот это уже посерьёзнее! Но в целом ничего страшного.<br>Мы легко восстановим все ваши зонды всего за <0> cr. Договорились?"    
    },
    {
      "#":"577",
      "String":"Сейчас посмотрим...<br>...<br>Все ваши зонды в отличном состоянии и не требуют ремонта."    
    },
    {
      "#":"578",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Хмм, ну, вроде, ничего серьёзного. Всё устраним и восстановим за <0> cr.<br>Устроит вас такая цена?"    
    },
    {
      "#":"579",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Похоже, все ваши зонды в отличной кондиции, и ремонта не требуют."    
    },
    {
      "#":"580",
      "String":"Ну вот и чудненько!<br>Все ваши зонды отремонтированы, отреставрированы и сейчас буквально сияют новизной!"    
    },
    {
      "#":"581",
      "String":"От всей души благодарю, что не отказались, увидев цену!<br>Все ваши артефакты отремонтированы, отреставрированы и сейчас буквально сияют новизной!"    
    },
    {
      "#":"582",
      "String":"Замечательно! Механики закончат с минуты на минуту.<br>Предлагаю вам осмотреть транклюкатора и оценить результат - лучший ремонт в Галактике!"    
    },
    {
      "#":"583",
      "String":"Замечательно! Механики закончат с минуты на минуту.<br>Предлагаю вам пройти на корабль и оценить результат - лучший ремонт в Галактике!"    
    },
    {
      "#":"584",
      "String":"Неприемлемо, <Player>, для вас будет болтаться в космосе в качестве газового облака, а тратить кредиты на ремонт корабля - это ещё вполне сносная альтернатива.<br>Дело, конечно, ваше, но лично я бы рекомендовал на своей \"птичке\" не экономить."    
    },
    {
      "#":"585",
      "String":"Больно видеть неуважение к столь замечательной технике! Транклюкатор, <Player> - машина умная, послушная, надёжная, а вы с ним как с трассионным сканером!<br>Ну вот что за рейнджеры пошли, ей-богу? Им техническое чудо предлагают на блюдечке, а они только знай нос воротить. Тьфу!"    
    },
    {
      "#":"586",
      "String":"Не стоит пренебрегать лояльностью наёмника, <Player>. Эти ребята - бойцы что надо!<br>Я и сам, однажды, наёмником служил, так вот у них заботливый клиент всегда получает надёжную охрану. А тот, кто парней на поле боя бросал, да лишнюю копейку зажимал - того в списке живых пилотов уже и не сыщешь."    
    },
    {
      "#":"587",
      "String":"Эх, зря вы так со своим напарником, <Player>. В такие времена необходимо друг другу помогать, а за друзей так вообще, как за жизнь, цепляться!<br>Сегодня вы ему плечо подставите, а завтра он вам. Эх, зря вы с ним так, очень даже зря..."    
    },
    {
      "#":"588",
      "String":"Эхэхэ... Оставите вы нас так и вовсе без работы, да без гроша к обеду.<br>Ну ничего страшного, быть может, с другим клиентом повезёт."    
    },
    {
      "#":"590",
      "String":"Ну, смотри, братан - наши местные кулибины от гаечного плазмоключа и шестерни чинят вообще всё, да притом бесплатно и без SMS. Хотя про бесплатно - это я тебя приколол, жить то им на что-то надо.<br>Короче, на выбор можем предложить <clr>пять<clrEnd> вариантов:<br><0><br><clr>1.<clrEnd> Ремонт оборудования, установленного прямо сейчас<br><clr>2.<clrEnd> Ремонт оборудования в составе всех твоих комплектаций (и текущей тоже)<br><clr>3.<clrEnd> Ремонт всех артефактов, что найдём у тебя на борту<br><clr>4.<clrEnd> Ремонт всех твоих исследовательских зондов<br><clr>5.<clrEnd> Всё вместе (вообще всё), типа \"all inclusive\"<br><1><br>Что выбираешь?"    
    },
    {
      "#":"603",
      "String":"Наши ремонтники могут починить и провести профилактику любого оборудования на корабле. Всё установленное оборудование - как стандартное, так и специальное - после нашего ремонта будет как новенькое. Услуги обойдутся недёшево, но зато работа будет произведена идеально.<br>На выбор мы можем предложить один из <clr>пяти<clrEnd> вариантов комплексного ремонта:<br><0><br><clr>1.<clrEnd> Ремонт оборудования, установленного в настоящий момент<br><clr>2.<clrEnd> Ремонт оборудования, входящего в состав всех ваших комплектаций (включая текущую)<br><clr>3.<clrEnd> Ремонт всех артефактов в слотах и в трюме<br><clr>4.<clrEnd> Ремонт всех исследовательских зондов<br><clr>5.<clrEnd> Ремонт вообще всего, что только можно починить на борту<br><1><br>Так что из этого вам необходимо?"    
    },
    {
      "#":"604",
      "String":"Починить, говорите? Это вы по адресу!<br>Наша сеть технологических центров уже давно славится самыми качественными и самыми быстрыми ремонтами в Галактике! Да что говорить! Первый центр был ОСНОВАН на желании обеспечить всех желающих качественным и доступным техсервисом. Но предупреждаю сразу - на ремонт нестандартного оборудования у нас наценка. Эти жлобы с научных баз свою копеечку с лицензии считают как никто.<br>Итак, на выбор мы можем предложить <clr>пять<clrEnd> вариантов оперативной починки:<br><0><br><clr>1.<clrEnd> Ремонт оборудования, установленного в настоящий момент<br><clr>2.<clrEnd> Ремонт оборудования, входящего в состав всех ваших комплектаций (включая текущую)<br><clr>3.<clrEnd> Ремонт всех артефактов в слотах и в трюме<br><clr>4.<clrEnd> Ремонт всех исследовательских зондов<br><clr>5.<clrEnd> Ремонт вообще всего, что только можно починить на борту<br><1><br>Какой предпочитаете?"    
    },
    {
      "#":"605",
      "String":"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт твоего транклюкатора тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"606",
      "String":"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего братана тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"607",
      "String":"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего чегевара тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"608",
      "String":"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт корыта твоего наёмника тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"609",
      "String":"</color>Ну вот что, <Player>. По нашим расценкам полный ремонт твоего корабля тянет на <0> cr. Однако, с учётом твоего пиратского рейтинга, мы готовы предложить тебе персональную скидку в <1><clr>%<clrEnd>."    
    },
    {
      "#":"610",
      "String":"Сейчас посмотрим...<br>...<br><0><br><1><br><br>Вот наша калькуляция:<br><2><br>Ремонт оборудования: <3><4> cr.<br>Нестандартный ремонт: <5><6> cr.<br>Доп. материалы: <7><8> нд.<br>Ремонт артефактов: <9><10> cr.<br><11><br>Итого: <12><13> cr. и <14> нд.<br><br>Согласен, много - а что поделаешь? Поломок-то ведь тьма тьмущая!"    
    },
    {
      "#":"611",
      "String":"Сейчас посмотрим...<br>...<br>Так, так... Есть некоторые поломки, мы всё это устраним за символическую плату. О'кей?<br><0><br><br>Смотрите, вот наша калькуляция:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Нестандартный ремонт: <4><5> cr.<br>Доп. материалы: <6><7> нд.<br>Ремонт артефактов: <8><9> cr.<br><10><br>Итого: <11><12> cr. и <13> нд."    
    },
    {
      "#":"612",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br><0><br><1><br><br>Вот полная стоимость работ:<br><2><br>Ремонт оборудования: <3><4> cr.<br>Нестандартный ремонт: <5><6> cr.<br>Доп. материалы: <7><8> нд.<br>Ремонт артефактов: <9><10> cr.<br><11><br>Итого: <12><13> cr. и <14> нд.<br><br>Да, недёшево, однако и работы тут непочатый край - уж не обессудьте."    
    },
    {
      "#":"613",
      "String":"Так-так, проведём-ка техосмотр...<br>...<br>Да, похоже, кое-что и, правда, поломалось, но ничего серьёзного. Исправим в считанные часы.<br><0><br><br>Вот полная стоимость работ:<br><1><br>Ремонт оборудования: <2><3> cr.<br>Нестандартный ремонт: <4><5> cr.<br>Доп. материалы: <6><7> нд.<br>Ремонт артефактов: <8><9> cr.<br><10><br>Итого: <11><12> cr. и <13> нд."    
    },
    {
      "#":"82",
      "String":"Я согласен заплатить"    
    },
    {
      "#":"87",
      "String":"Чинить оборудование в составе комплектаций"    
    },
    {
      "#":"89",
      "String":"Сейчас посмотрим...<br>...<br>Все ваши артефакты в отличном состоянии и не требуют ремонта."    
    },
    {
      "#":"9",
      "String":"Спасибо, но это для меня неприемлемо"    
    },
    {
      "#":"91",
      "String":"Чинить артефакты"    
    },
    {
      "#":"98",
      "String":"Чинить оборудование братана <0>"    
    },
    {
      "#":"99",
      "String":"Чинить оборудование наёмника <0>"    
    }  
  ]
}