Script ^{
    Mod_ExpCaravan ^{
		5=Да чтоб у тебя коммуникатор треснул! Проваливай с экрана, <Player>, мне сейчас ну вот совсем не до твоей мерзкой рожи!
		13=А, это ты, <Player>. Извини, но болтать с тобой мне некогда, поговорим в другой раз.
		14=Здравствуй, <Player>! Искренне рад встретить тебя на этих бескрайних космических просторах.<br>К сожалению, сейчас совсем нет времени болтать, я очень сильно занят, но честно обещаю пропустить с тобой по кружечке "Махпеллы" как-нибудь в другой раз.
		15=А, проклятый пират! Ну иди-ка сюда! Иди, и я по тебе так вдарю, что к клисанам в соседний рукав улетишь!!!
		16=Эй, а ну не занимай эту частоту! Я выполняю важное задание и у меня сейчас нет времени с тобой трепаться.
		19=Здравия желаю, <Player>! Прошу меня простить, но прямо сейчас я нахожусь на задании и не могу отвлекаться.
		17=<0>
		4=Конец связи
    }
    Mod_ExpCaravan_PB ^{
		0=Слышьте, где тут у вас сбарыжить можно непосильным трудом нажитое?
		14=Контейнеры
		15=Контейнер
		4=Чего, <Player>, развёл на груз какого-то лошка? А ты, я погляжу, совсем не так прост, хотя по морде лица твоей и не скажешь, что способен на такое. Лады, давай мы с корешами глянем, чего там у тебя трюм коптит.<br>...<br>Ну, в общем, мы тут с пацанами покумекали и пришли к выводу, что <0> cr. вполне готовы отжалеть за твоё барахло. Но ни кредитом больше, извиняй. Я тебе не внук Роок-Феел'Эра.
		9=Э, слышь! Ну ты берега-то свои знай, в натуре! А то ведь мы за такое и обидеть можем.
		16=Ну, значит, по рукам! <0> из трюма мы уже отгрузили, а вот и твои денюшки, получите - распишитесь.<br>И это, ещё... Уважуха тебе, короче. Всё правильно сделал, клан не забудет.
		11=Могли бы и больше предложить, но так уж и быть, продам по-братски. Мне всё равно влом куда-то ещё с этой фигнёй переться
		6=Пфф! В пираты что, одни нищеброды идут? Да мне это не возместит даже перегрева пушек!
    }
}
UselessItems ^{
    ExpCaravan_CargoBox ^{
        Cost=Average
        Name=Контейнер с неизвестным грузом
        Owner=Maloc,Peleng,People,Fei,Gaal
        Size=1
        Text=Вам остаётся лишь догадываться о его содержимом.
    }
}
ShipInfo ^{
	AddInfo ^{
		CustomInfos ^{
			ExpCaravan_TransportInfos ^{
				Description=Скрытая инфошка для записи последних координат транспорта
				Icon=0
				Name=
				OnActCodeTypes=t_OnDeath
				OnActCode ^{
					01=dword cur_ship = ScriptItemActShip();
					//02=if(!ShipInNormalSpace(cur_ship)) exit;
					02=g_last_transport_coords[0] = CoordX(cur_ship);
					03=g_last_transport_coords[1] = CoordY(cur_ship);
				}
			}
			ExpCaravan_WarriorShotInfos ^{
				Description=Скрытая инфошка для возможности осуществления выстрела военного по контейнеру
				Icon=0
				Name=
				OnActCodeTypes=t_OnStep,t_OnDeath
				OnActStepTypes=3,4,5,6,7,8,9
				OnActCode ^{
					01=dword cur_ship = ScriptItemActShip();
					02=if(ScriptItemActionType(t_OnStep))
					03 ^{
						01=if(cur_ship)
						02 ^{
							01=if(ShipInNormalSpace(cur_ship))
							02 ^{
								01=dword cur_info = CurInfo();
								02=for(int i = 1; i <= 3; i = i + 1)
								03 ^{
									01=dword container = ShipCustomShipInfoData(0, cur_info, i);
									02=if(container)
									03 ^{
										01=container = IdToItem(container);
										//Проверяем, что контейнер ещё цел
										02=if(container)
										03 ^{
											//Проверяем, что контейнер ещё болтается в системе (если его подобрали, то попытка выстрелить по нему закончится крашем)
											01=if(ItemIn(container, ShipStar(cur_ship)))
											02 ^{
												01=int j = i; //Смещение к орудию в зависимости от номера груза, чтобы не получилось, что военный расстреливает все грузы из всего одной пушки за один ход
												02=dword gun = 0;
												03=while(!gun)// || GetEquipmentStats(gun, 3) == 2)
												04 ^{
													01=gun = ShipEqInSlot(cur_ship, t_Weapon1, j);
													02=j = j + 1;
													03=if(j > 5) break;
												}
												05=if(gun) FireWeapon(cur_ship, container, gun);
												//Завершаем цикл после выстрела, чтобы один корабль не мог выстрелить сразу три раза одновременно
												06=break;
											}
										}
										//Обнуляем маркер военного как знак, что груз был успешно уничтожен
										04=ShipCustomShipInfoData(0, cur_info, i, 0);
										05=SetData(GetData(1, cur_ship) - (1 << i), 1, cur_ship);
									}
								}
							}
						}
					}
					//Военный летел подбирать контейнер, но по пути его убили
					//Сбрасываем маркер подбора с контейнера, чтобы другие военные могли перераспределить роли
					04=else //if(ScriptItemActionType(t_OnDeath))
					05 ^{
						01=if(GetData(0, cur_ship))
						02 ^{
							01=ScriptItemData(ScriptItemToItem(GetValueFromScript('Mod_ExpCaravan', 'Cargo_' + GetData(0, cur_ship))), 1, 0);
						}
					}
				}
			}
		}
	}
}